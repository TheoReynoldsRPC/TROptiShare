<?xml version="1.0" encoding="utf-8"?>
<TycheProject xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
  <TycheProjectFileVersion>2</TycheProjectFileVersion>
  <TycheVersion>211.0.1.21203</TycheVersion>
  <IsAuditingEnabled>false</IsAuditingEnabled>
  <TycheProjectEngineContents>
    <TycheEngine xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
      <FileVersion>1</FileVersion>
      <LastLoadedEngineVersion>
        <BuildNumber>0</BuildNumber>
        <MajorVersionNumber>0</MajorVersionNumber>
        <MinorVersionNumber>0</MinorVersionNumber>
        <PatchNumber>0</PatchNumber>
      </LastLoadedEngineVersion>
      <Globals>
        <ScenarioCount>10000</ScenarioCount>
        <RandomSeed>749216459</RandomSeed>
        <UsePerNodeSeeding>true</UsePerNodeSeeding>
        <AutomaticClearResults>false</AutomaticClearResults>
        <AutomaticFreeMemory>false</AutomaticFreeMemory>
        <SparseVectorThreshold>0.01</SparseVectorThreshold>
        <SIMDGlobalNumThreads>-1</SIMDGlobalNumThreads>
        <ModelDescription></ModelDescription>
        <ManagedGlobalNumThreads>1</ManagedGlobalNumThreads>
        <UseDependencyGroups>true</UseDependencyGroups>
        <CheckIndexingVariables>false</CheckIndexingVariables>
        <CheckVariablesAndTypes>false</CheckVariablesAndTypes>
        <FatalReportLevel>Error</FatalReportLevel>
        <IssueWarningForExperimentalFeatures>true</IssueWarningForExperimentalFeatures>
        <CheckDimensionNames>None</CheckDimensionNames>
        <CheckNonDistributedFunctions>None</CheckNonDistributedFunctions>
        <ToolkitRequirements />
      </Globals>
      <TopLevelModelNodes>
        <TycheNode xmlns="" i:type="TycheNodeExport">
          <fAttachedData i:nil="true" />
          <NodeType>Export</NodeType>
          <Name>Export</Name>
          <Description></Description>
          <Author>Wee Shen Teo (WT02)</Author>
          <Text></Text>
          <CacheResultValues>true</CacheResultValues>
          <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
          <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
          <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
          <NumScenariosDefault>0</NumScenariosDefault>
          <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
          <Breakpoints />
          <NestedSettings i:nil="true" />
          <Children />
          <ChildrenEdges />
          <ExportSettings>
            <InputVariables>
              <TycheInputVariable>
                <VariableName>ExpectedProfit</VariableName>
                <AncestorNodeName>Profit And Capital</AncestorNodeName>
                <AncestorVariableName>ExpectedProfit</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>Capital</VariableName>
                <AncestorNodeName>Profit And Capital</AncestorNodeName>
                <AncestorVariableName>Capital</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>OEPAEP</VariableName>
                <AncestorNodeName>Calc Combined OEPAEP</AncestorNodeName>
                <AncestorVariableName>OEPAEP</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>CATOEPAEP</VariableName>
                <AncestorNodeName>Calc CAT Only OEPAEP</AncestorNodeName>
                <AncestorVariableName>CATOEPAEP</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>CATOEPAEPContribution</VariableName>
                <AncestorNodeName>Calc CAT Only OEPAEP</AncestorNodeName>
                <AncestorVariableName>CATOEPAEPContribution</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>SPComponents</VariableName>
                <AncestorNodeName>Profit And Capital</AncestorNodeName>
                <AncestorVariableName>SPComponents</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>SPCapitalByLoB</VariableName>
                <AncestorNodeName>Profit And Capital</AncestorNodeName>
                <AncestorVariableName>SPCapitalByLoB</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>StandaloneSPCapitalByLoB</VariableName>
                <AncestorNodeName>Profit And Capital</AncestorNodeName>
                <AncestorVariableName>StandaloneSPCapitalByLoB</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
            </InputVariables>
            <OutputVariables />
            <IsContainer>false</IsContainer>
            <RandomSeed>1054684142</RandomSeed>
            <FileName></FileName>
            <RetainOutputVariables>false</RetainOutputVariables>
          </ExportSettings>
        </TycheNode>
        <TycheNode xmlns="" i:type="TycheNodeOperation">
          <fAttachedData i:nil="true" />
          <NodeType>Operation</NodeType>
          <Name>Calc CAT Only OEPAEP</Name>
          <Description></Description>
          <Author>Guy Carpenter (U1157691)</Author>
          <Text>arg ConstraintTable = Import.ConstraintTable;
arg CatAggLosses = Import.CatAggLosses;
arg CatAggReinstatement = Import.CatAggReinstatement;
arg CatIndLosses = Import.CatIndLosses;
arg CatIndReinstatement = Import.CatIndReinstatement;

arg RICatAggRecovery = Import.RICatAggRecovery;
arg RICatAggReinstatement = Import.RICatAggReinstatement;
arg RICatIndRecovery = Import.RICatIndRecovery;
arg RICatIndReinstatement = Import.RICatIndReinstatement;

// determine required OEPAEP
arg OEPAEPDefinition = Import.CATOEPAEPDefinition;
arg inCedantsByContract = Import.CedantsByContract;

//set up variables
OEPAEP_Entity =  ConstraintTable["Cat","Entity",:,:,:,"Entity"];
OEPAEP_Perils = Reindex(ConstraintTable["Cat","Peril"], "basis", "curve", "label", "peril");
OEPAEP_Source  = Reindex(ConstraintTable["Cat","Cedant"], "basis", "curve", "label", "cedant");
OEPAEP_LPerc = ToDouble(ConstraintTable["Cat","Lower Percentile",:,:,:,"Lower Percentile"]);
OEPAEP_UPerc = ToDouble(ConstraintTable["Cat","Upper Percentile",:,:,:,"Upper Percentile"]);
InwardsIDByConstraint = Reindex(ConstraintTable[:,"InwardsID"], "lt", "basis", "curve", "label", "InwardsID");


//Determine unique OEPAEP definitions to calculate
DefByLabel = OEPAEPDefinition[:,"Entity"] + OEPAEPDefinition[:,"Cedant"] + OEPAEPDefinition[:,"Perils"] + OEPAEPDefinition[:,"Basis"] + OEPAEPDefinition[:,"Curve"];
UniqueDefs_[i][Distinct(DefByLabel)] = StringIndex(DefByLabel,i);
DefsLookup[i][IteratorSize(DefByLabel)] = UniqueDefs_[DefByLabel[i]];
OEPAEP_DefMapping[OEPAEP_LPerc] = DefsLookup[label];

GrossOEP =
		Sum[0,mind]( {
				Sum[ent,peril,InwardsID,lob,source,loss,sims]( CatIndLosses ),
				- Sum[ent,peril,InwardsID,lob,source,loss,sims]( CatIndReinstatement )
		} );
GrossAEP =
		Sum[0,mind]( {
				Sum[source,loss,mind,mbla]( GrossOEP ),
				Sum[ent,peril,InwardsID,lob,sims]( CatAggLosses ),
				- Sum[ent,peril,InwardsID,lob,sims]( CatAggReinstatement )
		} );
NetOEP =
		Sum[0,mind]( {
				GrossOEP,
				- Sum[ent,peril,InwardsID,lob,source,loss,sims]( RICatIndRecovery ),
				Sum[ent,peril,InwardsID,lob,source,loss,sims]( RICatIndReinstatement )
		} );
NetAEP =
		Sum[0,mind]( {
				Sum[source,loss,mind,mbla]( NetOEP ),
				Sum[ent,peril,InwardsID,lob,sims]( CatAggLosses ),
				- Sum[ent,peril,InwardsID,lob,sims]( CatAggReinstatement ),
				- Sum[ent,peril,InwardsID,lob,sims]( RICatAggRecovery ),
				Sum[ent,peril,InwardsID,lob,sims]( RICatAggReinstatement )
		} );

DummyString[i][0] = "";
DummySourceLoss[lob,source,loss][DummyString,DummyString,0] = 0;
DummyInwardsIDSourceLoss[InwardsID,lob,source,loss][DummyString,DummyString,DummyString,0] = 0;
DummyInwardsID[InwardsID,lob][DummyString,DummyString] = 0;
DummyLoB[lob][DummyString] = 0;

OEPExGroup[basis][{"Gross","Net"}] = { GrossOEP, NetOEP };
AEPExGroup[basis][{"Gross","Net"}] = { GrossAEP, NetAEP };
OEPGroup[basis,ent][{"Gross","Net"},{"Group"}] = Sum[0,mind]( OEPExGroup[basis] );
AEPGroup[basis,ent][{"Gross","Net"},{"Group"}] = Sum[0,mind]( AEPExGroup[basis] );
OEP = Glue[ent]( { OEPExGroup, OEPGroup } );
AEP = Glue[ent]( { AEPExGroup, AEPGroup } );

OEPShape[basis,curve,label][IndexingVariable(OEPAEP_Entity),SetsIntersection(IndexingVariable(OEPAEP_Entity[basis]), {"OEP"}), IndexingVariable(OEPAEP_Entity[basis,curve])] = label;
AEPShape[basis,curve,label][IndexingVariable(OEPAEP_Entity),SetsIntersection(IndexingVariable(OEPAEP_Entity[basis]), {"AEP"}), IndexingVariable(OEPAEP_Entity[basis,curve])] = label;
OEPFull_[OEPShape] = OEP [basis,OEPAEP_Entity[basis,curve,label],OEPAEP_Perils[basis,curve,label],default::DummyInwardsIDSourceLoss];
OEPFull[basis,curve,label,peril][IndexingVariable(OEPFull_),IndexingVariable(OEPFull_[basis]), IndexingVariable(OEPFull_[basis,curve]), IndexingVariable(OEPFull_[basis,curve,label])] = OEPFull_ [basis,curve,label,peril, InwardsIDByConstraint["Cat",basis,curve,label],default::DummySourceLoss];
AEPFull_[AEPShape] = AEP[basis,OEPAEP_Entity[basis,curve,label],OEPAEP_Perils[basis,curve,label],default::DummyInwardsID];
AEPFull[basis,curve,label,peril][IndexingVariable(AEPFull_),IndexingVariable(AEPFull_[basis]), IndexingVariable(AEPFull_[basis,curve]), IndexingVariable(AEPFull_[basis,curve,label])] = AEPFull_[basis,curve,label,peril,InwardsIDByConstraint["Cat",basis,curve,label],default::DummyLoB];

OEPAEPFullDistribution[basis,curve][IndexingVariable(OEPAEP_Entity),IndexingVariable(OEPAEP_Entity[basis])] =
		if curve == "OEP" then
				Replace( Max[source,loss,mind,mbla]( Sum[peril,InwardsID,lob,mind,mbla]( OEPFull[basis,curve]) ), -Infinity, 0 )
		else if curve == "AEP" then
				Sum[peril,InwardsID,lob,mind,mbla]( AEPFull[basis,curve] )
		else 0;

Labels = Group[label]( OEPAEP_DefMapping )[:,0];
Agg_OEPAEPFullDistribution = Sum[label,sims,mbla]( OEPAEPFullDistribution );

Labels_mapping_temp = Group[Agg_OEPAEPFullDistribution,Labels]( IteratorSize( Labels ) );
Labels_mapping[label,i][IteratorSize(Labels_mapping_temp),Labels_mapping_temp[label]] = i;
OEPAEP_PreShape[stat][{"OEPAEP"}] = 
	ReIndex( Sum[label,mind]( CDFInverseAverage( Sum[label,sims,mbla]( OEPAEPFullDistribution ), Sum[label]( OEPAEP_LPerc )[Labels_mapping], Sum[label]( OEPAEP_UPerc )[Labels_mapping] ) ), "label" );
MeanOEPAEP[stat][{"Mean"}] = Sum[label]( Mean[basis,curve,label](OEPAEPFullDistribution) )[Labels];
SDOEPAEP[stat][{"SD"}] = Sum[label]( StandardDeviation[basis,curve,label](OEPAEPFullDistribution) )[Labels];

out CATOEPAEP = Sum[label,stat]( { OEPAEP_PreShape, MeanOEPAEP, SDOEPAEP } );

//labels and percs re-organised
OEPAEP_Labels = Transpose[label,basis,curve](OEPAEP_Entity);
OEPLabels[label][Flatten(OEPShape)] = label;
AEPLabels[label][Flatten(AEPShape)] = label;
LPercsByLabel = Sum[label]( OEPAEP_LPerc );
UPercsByLabel = Sum[label]( OEPAEP_UPerc );

//determine the contribution of individual lobs to the OEP / AEP
OEPBySourceLossLoB = Sum[label,source,loss,lob,sims,mbla]( OEPFull);
OEPBySourceLoss = Sum[lob,mind](OEPBySourceLossLoB);
OEPMaxAndPositions[OEPLabels] = GetMaxAndPositions(OEPBySourceLoss[label], "First");
OEPFullDistribution = OEPMaxAndPositions[:,2];//Max and positions gives results 0 - outer position, 1 - inner position, 2 - actual max value, so we select the value

OEPScenarios[OEPLabels] = 
	If LPercsByLabel[label] == UPercsByLabel[label]
		Then CDFInverseAverageScenarios(OEPFullDistribution[label], LPercsByLabel[label]-0.005, UPercsByLabel[label]+0.005)
		Else CDFInverseAverageScenarios(OEPFullDistribution[label], LPercsByLabel[label], UPercsByLabel[label]);

OEPContribution[OEPLabels] = 
	GetOEPContribution(OEPScenarios[label], OEPBySourceLossLoB[label], Round(OEPMaxAndPositions[label, 0]), Round(OEPMaxAndPositions[label, 1]));


AEPByLabelLob = Sum[label,lob,sims,mbla]( AEPFull );
AEPByLabel = Sum[lob,mind,mbla]( AEPByLabelLob );

AEPScenarios[AEPLabels] = 
	If LPercsByLabel[label] == UPercsByLabel[label]
	Then 	CDFInverseAverageScenarios(AEPByLabel[label], LPercsByLabel[label]-0.005, UPercsByLabel[label]+0.005)
	Else CDFInverseAverageScenarios(AEPByLabel[label], LPercsByLabel[label], UPercsByLabel[label]);

AEPContribution[AEPLabels] = AEPByLabelLob[label]&lt;&lt;AEPScenarios[label]&gt;&gt;;

out CATOEPAEPContribution[basis,curve][IndexingVariable(OEPAEP_Entity),IndexingVariable(OEPAEP_Entity[basis])]  = if curve == "OEP" then OEPContribution else AEPContribution;</Text>
          <CacheResultValues>true</CacheResultValues>
          <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
          <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
          <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
          <NumScenariosDefault>0</NumScenariosDefault>
          <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
          <Breakpoints />
          <NestedSettings xmlns="" i:type="TycheSettingsContainer">
            <InputVariables />
            <OutputVariables />
            <IsContainer>false</IsContainer>
            <RandomSeed>1465498056</RandomSeed>
          </NestedSettings>
          <Children />
          <ChildrenEdges />
        </TycheNode>
        <TycheNode xmlns="" i:type="TycheNodeOperation">
          <fAttachedData i:nil="true" />
          <NodeType>Operation</NodeType>
          <Name>Calc Combined OEPAEP</Name>
          <Description></Description>
          <Author>Guy Carpenter (U1157691)</Author>
          <Text>arg ConstraintTable = Import.ConstraintTable;
arg CatAggLosses = Import.CatAggLosses;
arg CatAggReinstatement = Import.CatAggReinstatement;
arg CatIndLosses = Import.CatIndLosses;
arg CatIndReinstatement = Import.CatIndReinstatement;
arg NonCatAggLosses = Import.NonCatAggLosses;
arg NonCatIndLosses = Import.NonCatIndLosses;
arg NonCatIndReinstatement = Import.NonCatIndReinstatement;
arg RICatAggRecovery = Import.RICatAggRecovery;
arg RICatAggReinstatement = Import.RICatAggReinstatement;
arg RICatIndRecovery = Import.RICatIndRecovery;
arg RICatIndReinstatement = Import.RICatIndReinstatement;
arg RINonCatAggRecovery = Import.RINonCatAggRecovery;
arg RINonCatIndRecovery = Import.RINonCatIndRecovery;
arg RINonCatIndReinstatement = Import.RINonCatIndReinstatement;

// determine required OEPAEP
arg OEPAEPDefinition = Import.OEPAEPDefinition;
arg inCedantsByContract = Import.CedantsByContract;

//set up variables
OEPAEP_Entity =  ConstraintTable["Total","Entity",:,:,:,"Entity"];
OEPAEP_LoBs = Reindex(ConstraintTable["Total","LoBs"], "basis", "curve", "label", "lob");
OEPAEP_Source  = Reindex(ConstraintTable["Total","Cedant"], "basis", "curve", "label", "cedant");
OEPAEP_LPerc = ToDouble(ConstraintTable["Total","Lower Percentile",:,:,:,"Lower Percentile"]);
OEPAEP_UPerc = ToDouble(ConstraintTable["Total","Upper Percentile",:,:,:,"Upper Percentile"]);
InwardsIDByConstraint = Reindex(ConstraintTable[:,"InwardsID"], "lt","basis", "curve", "label", "InwardsID");

DummyString[i][0] = "";
DummySourceLoss[source,loss][DummyString,0] = 0;
DummyInwardsIDSourceLoss[InwardsID,source,loss][DummyString,DummyString,0] = 0;
DummyInwardsID[InwardsID][DummyString] = 0;

//Determine unique OEPAEP definitions to calculate
DefByLabel = OEPAEPDefinition[:,"Entity"] + OEPAEPDefinition[:,"Cedant"] + OEPAEPDefinition[:,"LoBs"] + OEPAEPDefinition[:,"Basis"] + OEPAEPDefinition[:,"Curve"];
UniqueDefs_[i][Distinct(DefByLabel)] = StringIndex(DefByLabel,i);
DefsLookup[i][IteratorSize(DefByLabel)] = UniqueDefs_[DefByLabel[i]];
OEPAEP_DefMapping[OEPAEP_LPerc] = DefsLookup[label];

//===CAT LOSSES===
GrossCATOEP =
		Sum[0,mind]( {
				Sum[ent,lob,InwardsID,source,loss,sims]( CatIndLosses ),
				- Sum[ent,lob,InwardsID,source,loss,sims]( CatIndReinstatement )
		} );
GrossCATAEP =
		Sum[0,mind]( {
				Sum[source,loss,mind,mbla]( GrossCATOEP ),
				Sum[ent,lob,InwardsID,sims]( CatAggLosses ),
				- Sum[ent,lob,InwardsID,sims]( CatAggReinstatement )
		} );
NetCATOEP =
		Sum[0,mind]( {
				GrossCATOEP,
				- Sum[ent,lob,InwardsID,source,loss,sims]( RICatIndRecovery ),
				Sum[ent,lob,InwardsID,source,loss,sims]( RICatIndReinstatement )
		} );
NetCATAEP =
		Sum[0,mind]( {
				Sum[source,loss,mind,mbla]( NetCATOEP ),
				Sum[ent,lob,InwardsID,sims]( CatAggLosses ),
				- Sum[ent,lob,InwardsID,sims]( CatAggReinstatement ),
				- Sum[ent,lob,InwardsID,sims]( RICatAggRecovery ),
				Sum[ent,lob,InwardsID,sims]( RICatAggReinstatement )
		} );

CATOEPExGroup[basis][{"Gross","Net"}] = { GrossCATOEP, NetCATOEP };
CATAEPExGroup[basis][{"Gross","Net"}] = { GrossCATAEP, NetCATAEP };
CATOEPGroup[basis,ent][{"Gross","Net"},{"Group"}] = Sum[0,mind]( CATOEPExGroup[basis] );
CATAEPGroup[basis,ent][{"Gross","Net"},{"Group"}] = Sum[0,mind]( CATAEPExGroup[basis] );
CATOEP = Glue[ent]( { CAtOEPExGroup, CATOEPGroup } );
CATAEP = Glue[ent]( { CATAEPExGroup, CATAEPGroup } );

CATOEPFull_[OEPAEP_Entity] = CATOEP [basis,OEPAEP_Entity[basis,curve,label],OEPAEP_LoBs[basis,curve,label],default::DummyInwardsIDSourceLoss];
CATOEPFull[OEPAEP_LoBs] = CATOEPFull_ [basis,curve,label,lob, InwardsIDByConstraint["Total",basis,curve,label],default::DummySourceLoss];
CATAEPFull_[OEPAEP_Entity] = CATAEP[basis,OEPAEP_Entity[basis,curve,label],OEPAEP_LoBs[basis,curve,label],default::DummyInwardsID];
CATAEPFull[OEPAEP_LoBs] = CATAEPFull_[basis,curve,label,lob,InwardsIDByConstraint["Total",basis,curve,label],default::0];

//===NONCAT LOSSES===
GrossOEP =
		Sum[0,mind]( {
				Sum[ent,lob,InwardsID,source,loss,sims]( NonCatIndLosses ),
				- Sum[ent,lob,InwardsID,source,loss,sims]( NonCatIndReinstatement )
		} );
GrossAEP =
		Sum[0,mind]( {
				Sum[source,loss,mind,mbla]( GrossOEP ),
				Sum[ent,lob,InwardsID,sims]( NonCatAggLosses )
		} );
NetOEP =
		Sum[0,mind]( {
				GrossOEP,
				- Sum[ent,lob,InwardsID,source,loss,sims]( RINonCatIndRecovery ),
				Sum[ent,lob,InwardsID,source,loss,sims]( RINonCatIndReinstatement )
		} );
NetAEP =
		Sum[0,mind]( {
				Sum[source,loss,mind,mbla]( NetOEP ),
				Sum[ent,lob,InwardsID,sims]( NonCatAggLosses ),
				- Sum[ent,lob,InwardsID,sims]( RINonCatAggRecovery )
		} );


OEPExGroup[basis][{"Gross","Net"}] = { GrossOEP, NetOEP };
AEPExGroup[basis][{"Gross","Net"}] = { GrossAEP, NetAEP };
OEPGroup[basis,ent][{"Gross","Net"},{"Group"}] = Sum[0,mind]( OEPExGroup[basis] );
AEPGroup[basis,ent][{"Gross","Net"},{"Group"}] = Sum[0,mind]( AEPExGroup[basis] );
OEP = Glue[ent]( { OEPExGroup, OEPGroup } );
AEP = Glue[ent]( { AEPExGroup, AEPGroup } );

OEPFull_[OEPAEP_Entity] = OEP [basis,OEPAEP_Entity[basis,curve,label],OEPAEP_LoBs[basis,curve,label],default::DummyInwardsIDSourceLoss];
OEPFull[OEPAEP_LoBs] = OEPFull_ [basis,curve,label,lob, InwardsIDByConstraint["Total",basis,curve,label],default::DummySourceLoss];
AEPFull_[OEPAEP_Entity] = AEP[basis,OEPAEP_Entity[basis,curve,label],OEPAEP_LoBs[basis,curve,label],default::DummyInwardsID];
AEPFull[OEPAEP_LoBs] = AEPFull_[basis,curve,label,lob,InwardsIDByConstraint["Total",basis,curve,label],default::0];

MaxCATOEP = Replace( Max[source,loss,mind,mbla]( Sum[lob,InwardsID,mind,mbla]( CATOEPFull ) ), -Infinity, 0 );
MaxOEP = Replace( Max[source,loss,mind,mbla]( Sum[lob,InwardsID,mind,mbla]( OEPFull ) ), -Infinity, 0 );
TotalCATAEP = Sum[lob,InwardsID,mind,mbla]( CATAEPFull );
TotalAEP = Sum[lob,InwardsID,mind,mbla]( AEPFull );

//temporary - exclude cat, just calculate NonCat
OEPAEPFullDistribution[OEPAEP_Entity] =
		if curve == "OEP" then
				Max(MaxCATOEP[basis,curve,label], MaxOEP[basis,curve,label])
		else if curve == "AEP" then
				TotalCATAEP[basis,curve,label] + TotalAEP[basis,curve,label]
		else 0;

Labels = Group[label]( OEPAEP_DefMapping )[:,0];
Agg_OEPAEPFullDistribution = Sum[label,sims,mbla]( OEPAEPFullDistribution );

Labels_mapping_temp = Group[Agg_OEPAEPFullDistribution,Labels]( IteratorSize( Labels ) );
Labels_mapping[label,i][IteratorSize(Labels_mapping_temp),Labels_mapping_temp[label]] = i;
OEPAEP_PreShape[stat][{"OEPAEP"}] = 
	ReIndex( Sum[label,mind]( CDFInverseAverage( Sum[label,sims,mbla]( OEPAEPFullDistribution ), Sum[label]( OEPAEP_LPerc )[Labels_mapping], Sum[label]( OEPAEP_UPerc )[Labels_mapping] ) ), "label" );
MeanOEPAEP[stat][{"Mean"}] = Sum[label]( Mean[basis,curve,label](OEPAEPFullDistribution) )[Labels];
SDOEPAEP[stat][{"SD"}] = Sum[label]( StandardDeviation[basis,curve,label](OEPAEPFullDistribution) )[Labels];

out OEPAEP = Sum[label,stat]( { OEPAEP_PreShape, MeanOEPAEP, SDOEPAEP } );</Text>
          <CacheResultValues>true</CacheResultValues>
          <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
          <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
          <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
          <NumScenariosDefault>0</NumScenariosDefault>
          <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
          <Breakpoints />
          <NestedSettings xmlns="" i:type="TycheSettingsContainer">
            <InputVariables />
            <OutputVariables />
            <IsContainer>false</IsContainer>
            <RandomSeed>171972861</RandomSeed>
          </NestedSettings>
          <Children />
          <ChildrenEdges />
        </TycheNode>
        <TycheNode xmlns="" i:type="TycheNodeExcelImport">
          <fAttachedData i:nil="true" />
          <NodeType>ExcelImport</NodeType>
          <Name>Import</Name>
          <Description></Description>
          <Author>Guy Carpenter (u1157691)</Author>
          <Text></Text>
          <CacheResultValues>true</CacheResultValues>
          <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
          <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
          <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
          <NumScenariosDefault>0</NumScenariosDefault>
          <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
          <Breakpoints />
          <NestedSettings i:nil="true" />
          <Children />
          <ChildrenEdges />
          <ExcelImportSettings>
            <InputVariables i:nil="true" />
            <OutputVariables i:nil="true" />
            <IsContainer>false</IsContainer>
            <RandomSeed>793742898</RandomSeed>
            <ExcelFileName>.\Calculate Risk Metrics_1.xlsx</ExcelFileName>
            <ExcelExportVariables />
            <ExcelImportVariables>
              <TycheOutputVariable_ExcelImport>
                <VariableName>Premium</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply Participation</SheetName>
                <CellsRange>Premium</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>CatAggLosses</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply Participation</SheetName>
                <CellsRange>CatAggLosses</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>CatAggReinstatement</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply Participation</SheetName>
                <CellsRange>CatAggReinstatement</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>CatIndLosses</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply Participation</SheetName>
                <CellsRange>CatIndLosses</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>CatIndReinstatement</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply Participation</SheetName>
                <CellsRange>CatIndReinstatement</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>NonCatAggLosses</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply Participation</SheetName>
                <CellsRange>NonCatAggLosses</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>NonCatIndLosses</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply Participation</SheetName>
                <CellsRange>NonCatIndLosses</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>NonCatIndReinstatement</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply Participation</SheetName>
                <CellsRange>NonCatIndReinstatement</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>RIPremium</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply ORI</SheetName>
                <CellsRange>RIPremium</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>RICatAggRecovery</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply ORI</SheetName>
                <CellsRange>RICatAggRecovery</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>RICatAggReinstatement</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply ORI</SheetName>
                <CellsRange>RICatAggReinstatement</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>RICatIndRecovery</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply ORI</SheetName>
                <CellsRange>RICatIndRecovery</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>RICatIndReinstatement</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply ORI</SheetName>
                <CellsRange>RICatIndReinstatement</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>RINonCatAggRecovery</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply ORI</SheetName>
                <CellsRange>RINonCatAggRecovery</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>RINonCatIndRecovery</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply ORI</SheetName>
                <CellsRange>RINonCatIndRecovery</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>RINonCatIndReinstatement</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply ORI</SheetName>
                <CellsRange>RINonCatIndReinstatement</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>CapitalDefinition</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Inputs</SheetName>
                <CellsRange>CapitalDefinition</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>CATOEPAEPDefinition</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Inputs</SheetName>
                <CellsRange>CATOEPAEPDefinition</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>Commission</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply Participation</SheetName>
                <CellsRange>Commission</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>CedingCommission</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply ORI</SheetName>
                <CellsRange>CedingCommission</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>CedantsByContract</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Inputs</SheetName>
                <CellsRange>CedantsByContract</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>OEPAEPDefinition</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Inputs</SheetName>
                <CellsRange>OEPAEPDefinition</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>ConstraintTable</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Inputs</SheetName>
                <CellsRange>ConstraintTable</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>FixedExpenses</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Apply Participation</SheetName>
                <CellsRange>FixedExpenses</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>SPAdjustedFactors</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Sheet1</SheetName>
                <CellsRange>A1</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>SPCatFactor</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Sheet1</SheetName>
                <CellsRange>A1</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>DiscountSwitch</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Inputs</SheetName>
                <CellsRange>DiscountSwitch</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>String</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>DiscountFactor</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Inputs</SheetName>
                <CellsRange>DiscountFactor</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>2</NumDimensions>
              </TycheOutputVariable_ExcelImport>
              <TycheOutputVariable_ExcelImport>
                <VariableName>Capital_ConstraintTable</VariableName>
                <ChildNodeName></ChildNodeName>
                <ChildVariableName></ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
                <SheetName>Inputs</SheetName>
                <CellsRange>Capital_ConstraintTable</CellsRange>
                <ImportAsScenarios>false</ImportAsScenarios>
                <ImportHeaders>None</ImportHeaders>
                <IsEnabled>true</IsEnabled>
                <DataType>Double</DataType>
                <IgnoreEmptyCells>true</IgnoreEmptyCells>
                <NumDimensions>0</NumDimensions>
              </TycheOutputVariable_ExcelImport>
            </ExcelImportVariables>
            <ExcelComplexImportVariables />
            <RecalculateAfterExport>true</RecalculateAfterExport>
          </ExcelImportSettings>
        </TycheNode>
        <TycheNode xmlns="" i:type="TycheNodeContainer">
          <fAttachedData i:nil="true" />
          <NodeType>Container</NodeType>
          <Name>Profit And Capital</Name>
          <Description></Description>
          <Author>Theo Reynolds (tr05)</Author>
          <Text></Text>
          <CacheResultValues>true</CacheResultValues>
          <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
          <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
          <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
          <NumScenariosDefault>0</NumScenariosDefault>
          <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
          <Breakpoints />
          <NestedSettings xmlns="" i:type="TycheSettingsContainer">
            <InputVariables>
              <TycheInputVariable>
                <VariableName>Premium</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>Premium</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>CatAggLosses</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>CatAggLosses</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>CatAggReinstatement</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>CatAggReinstatement</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>CatIndLosses</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>CatIndLosses</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>CatIndReinstatement</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>CatIndReinstatement</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>NonCatAggLosses</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>NonCatAggLosses</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>NonCatIndLosses</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>NonCatIndLosses</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>NonCatIndReinstatement</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>NonCatIndReinstatement</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>RIPremium</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>RIPremium</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>RICatAggRecovery</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>RICatAggRecovery</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>RICatAggReinstatement</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>RICatAggReinstatement</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>RICatIndRecovery</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>RICatIndRecovery</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>RICatIndReinstatement</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>RICatIndReinstatement</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>RINonCatAggRecovery</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>RINonCatAggRecovery</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>RINonCatIndRecovery</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>RINonCatIndRecovery</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>RINonCatIndReinstatement</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>RINonCatIndReinstatement</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>CapitalDefinition</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>CapitalDefinition</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>Commission</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>Commission</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>CedingCommission</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>CedingCommission</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>FixedExpenses</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>FixedExpenses</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>SPAdjustedFactors</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>SPAdjustedFactors</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>SPCatFactor</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>SPCatFactor</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>DiscountSwitch</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>DiscountSwitch</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>DiscountFactor</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>DiscountFactor</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>Capital_ConstraintTable</VariableName>
                <AncestorNodeName>Import</AncestorNodeName>
                <AncestorVariableName>Capital_ConstraintTable</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>PremiumByLt</VariableName>
                <AncestorNodeName>Premium Split</AncestorNodeName>
                <AncestorVariableName>PremiumByLt</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
              <TycheInputVariable>
                <VariableName>RIPremiumByLt</VariableName>
                <AncestorNodeName>Premium Split</AncestorNodeName>
                <AncestorVariableName>RIPremiumByLt</AncestorVariableName>
                <IsParallel>false</IsParallel>
                <IsBranchSelector>false</IsBranchSelector>
              </TycheInputVariable>
            </InputVariables>
            <OutputVariables>
              <TycheOutputVariable>
                <VariableName>ExpectedProfit</VariableName>
                <ChildNodeName>Profit</ChildNodeName>
                <ChildVariableName>ExpectedProfit</ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
              </TycheOutputVariable>
              <TycheOutputVariable>
                <VariableName>Capital</VariableName>
                <ChildNodeName>PostProcessing</ChildNodeName>
                <ChildVariableName>Capital</ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
              </TycheOutputVariable>
              <TycheOutputVariable>
                <VariableName>SPComponents</VariableName>
                <ChildNodeName>PostProcessing</ChildNodeName>
                <ChildVariableName>SPComponents</ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
              </TycheOutputVariable>
              <TycheOutputVariable>
                <VariableName>SPCapitalByLoB</VariableName>
                <ChildNodeName>PostProcessing</ChildNodeName>
                <ChildVariableName>SPCapitalByLoB</ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
              </TycheOutputVariable>
              <TycheOutputVariable>
                <VariableName>StandaloneSPCapitalByLoB</VariableName>
                <ChildNodeName>PostProcessing</ChildNodeName>
                <ChildVariableName>StandaloneSPCapitalByLoB</ChildVariableName>
                <CachedTypeData i:nil="true" />
                <IsEnabled>true</IsEnabled>
              </TycheOutputVariable>
            </OutputVariables>
            <IsContainer>true</IsContainer>
            <RandomSeed>241395405</RandomSeed>
          </NestedSettings>
          <Children>
            <TycheNode xmlns="" i:type="TycheNodeNestedInputs">
              <fAttachedData i:nil="true" />
              <NodeType>NestedInputs</NodeType>
              <Name>Inputs</Name>
              <Description></Description>
              <Author>Theo Reynolds (tr05)</Author>
              <Text></Text>
              <CacheResultValues>true</CacheResultValues>
              <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
              <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
              <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
              <NumScenariosDefault>0</NumScenariosDefault>
              <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
              <Breakpoints />
            </TycheNode>
            <TycheNode xmlns="" i:type="TycheNodeNestedOutputs">
              <fAttachedData i:nil="true" />
              <NodeType>NestedOutputs</NodeType>
              <Name>Outputs</Name>
              <Description></Description>
              <Author>Theo Reynolds (tr05)</Author>
              <Text></Text>
              <CacheResultValues>true</CacheResultValues>
              <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
              <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
              <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
              <NumScenariosDefault>0</NumScenariosDefault>
              <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
              <Breakpoints />
            </TycheNode>
            <TycheNode xmlns="" i:type="TycheNodeSwitch">
              <fAttachedData i:nil="true" />
              <NodeType>Switch</NodeType>
              <Name>Capital by Type</Name>
              <Description></Description>
              <Author>Theo Reynolds (tr05)</Author>
              <Text></Text>
              <CacheResultValues>true</CacheResultValues>
              <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
              <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
              <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
              <NumScenariosDefault>0</NumScenariosDefault>
              <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
              <Breakpoints />
              <NestedSettings xmlns="" i:type="TycheSettingsSwitch">
                <InputVariables>
                  <TycheInputVariable>
                    <VariableName>CapitalSwitch</VariableName>
                    <AncestorNodeName>Preprocess Switch</AncestorNodeName>
                    <AncestorVariableName>CapitalSwitch</AncestorVariableName>
                    <IsParallel>true</IsParallel>
                    <IsBranchSelector>true</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>CombinedProfit</VariableName>
                    <AncestorNodeName>Profit</AncestorNodeName>
                    <AncestorVariableName>CombinedProfit</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>SPAdjustedFactors</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>SPAdjustedFactors</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>SPCatFactor</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>SPCatFactor</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>RICatAggReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RICatAggReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>RICatIndRecovery</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RICatIndRecovery</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>RICatIndReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RICatIndReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>RINonCatAggRecovery</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RINonCatAggRecovery</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>RINonCatIndRecovery</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RINonCatIndRecovery</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>RINonCatIndReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RINonCatIndReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>RICatAggRecovery</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RICatAggRecovery</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>RIPremium</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RIPremium</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>NonCatIndReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>NonCatIndReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>NonCatIndLosses</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>NonCatIndLosses</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>NonCatAggLosses</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>NonCatAggLosses</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>CatIndReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>CatIndReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>CatIndLosses</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>CatIndLosses</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>CatAggReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>CatAggReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>CatAggLosses</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>CatAggLosses</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>Premium</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>Premium</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>Commission</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>Commission</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>CedingCommission</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>CedingCommission</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>Capital_ConstraintTable</VariableName>
                    <AncestorNodeName>Preprocess Switch</AncestorNodeName>
                    <AncestorVariableName>Capital_ConstraintTable</AncestorVariableName>
                    <IsParallel>true</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>PremiumByLt</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>PremiumByLt</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>RIPremiumByLt</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RIPremiumByLt</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                </InputVariables>
                <OutputVariables>
                  <TycheOutputVariable>
                    <VariableName>StandaloneSPCapitalByLoB</VariableName>
                    <ChildNodeName>SP</ChildNodeName>
                    <ChildVariableName>StandaloneSPCapitalByLoB</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>SPCapitalByLoB</VariableName>
                    <ChildNodeName>SP</ChildNodeName>
                    <ChildVariableName>SPCapitalByLoB</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>Capital</VariableName>
                    <ChildNodeName>SP</ChildNodeName>
                    <ChildVariableName>Capital</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>SPComponents</VariableName>
                    <ChildNodeName>SP</ChildNodeName>
                    <ChildVariableName>SPComponents</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                </OutputVariables>
                <IsContainer>true</IsContainer>
                <RandomSeed>1206098724</RandomSeed>
                <ParalleliseBy>TopDimension</ParalleliseBy>
                <ParallelisationMethod>Series</ParallelisationMethod>
                <NumThreads>2</NumThreads>
                <SwitchBranchSettings>
                  <TycheSettingsSwitchBranch>
                    <BranchName>SP</BranchName>
                    <IsContainer>false</IsContainer>
                  </TycheSettingsSwitchBranch>
                  <TycheSettingsSwitchBranch>
                    <BranchName>Economic</BranchName>
                    <IsContainer>false</IsContainer>
                  </TycheSettingsSwitchBranch>
                </SwitchBranchSettings>
                <Grid>
                  <GridTransferType>ByRequest</GridTransferType>
                  <HostName>localhost</HostName>
                  <MaximumGridRequests>100</MaximumGridRequests>
                  <NodesJobTemplate i:nil="true" />
                  <PortRangeHighest>7460</PortRangeHighest>
                  <PortRangeLowest>7443</PortRangeLowest>
                  <Priority>
                    <Value>2000</Value>
                  </Priority>
                  <RuntimeDirectory i:nil="true" />
                  <UseGridEmulation>false</UseGridEmulation>
                  <GridSettingsOrigin>FromParent</GridSettingsOrigin>
                </Grid>
                <ReseedEachExecution>true</ReseedEachExecution>
              </NestedSettings>
              <Children>
                <TycheNode xmlns="" i:type="TycheNodeContainer">
                  <fAttachedData i:nil="true" />
                  <NodeType>Container</NodeType>
                  <Name>SP</Name>
                  <Description></Description>
                  <Author>Theo Reynolds (tr05)</Author>
                  <Text>//this node calculates the S&amp;P capital charge

//Premium Risk Charge
NetCatLossByLoB = 
			Sum[0,mind]( {
				Sum[lob,ent,InwardsID,sims,mbla]( CatAggLosses ),
				Sum[lob,ent,InwardsID,sims,mbla]( CatIndLosses ),
				-Sum[lob,ent,InwardsID,sims,mbla]( RICatAggRecovery ),
				-Sum[lob,ent,InwardsID,sims,mbla]( RICatIndRecovery ) });
NetCatLossByLoB_Mean = Mean[sims,mind](NetCatLossByLoB);

NetNonCatLossByLoB_Mean = 
		Sum[0,mind]( {
				Sum[lob,ent,InwardsID,mbla]( NonCatAggLosses ),
				Sum[lob,ent,InwardsID,mbla]( NonCatIndLosses ),
				-Sum[lob,ent,InwardsID,mbla]( RINonCatAggRecovery ),
				-Sum[lob,ent,InwardsID,mbla]( RINonCatIndRecovery )	}) / NumScenarios(NonCatAggLosses);

//determine a premium allocation between noncat and cat based on mean net premium
NetPremByLtLoB = Sum[0,mind]({ Sum[lt,lob,ent,InwardsID]( PremiumByLt ) / NumScenarios( PremiumByLt ),
											-Sum[lt,lob,ent,InwardsID,mbla]( RIPremiumByLt ) / NumScenarios( RIPremiumByLt ) });


SPPremiumRisk = NetPremByLtLoB["NonCat"] * SPAdjustedFactors ["Premium Risk",IndexingVariable(NetPremByLtLoB["NonCat"]),default::0];
SPCatPremium = PadToPattern(NetPremByLtLoB["Cat"], NetCatNetRIPLossByLoB,0);

//Reserve Risk Charge
SPReserveRisk = Sum[0,mind]( {
				NetCatLossByLoB_Mean * SPAdjustedFactors["Cat Reserves",IndexingVariable(NetCatLossByLoB_Mean),default::0],
				NetNonCatLossByLoB_Mean * SPAdjustedFactors["NonCat Reserves",IndexingVariable(NetNonCatLossByLoB_Mean),default::0] });


//Cat Risk Charge
NetCatRIPByLoB = 
	Sum[0,mind]({
					Sum[lob,ent,InwardsID,sims,mbla]( CatIndReinstatement ),
					Sum[lob,ent,InwardsID,sims,mbla]( CatAggReinstatement ),
					- Sum[lob,ent,InwardsID,sims,mbla]( RICatAggReinstatement ),	
					- Sum[lob,ent,InwardsID,sims,mbla]( RICatIndReinstatement ) });

NetCatNetRIPLossByLoB = 
			Sum[0,mind]( {
				NetCatLossByLoB,
				-NetCatRIPByLoB });

//standalone cat risk by lob
CatRiskByLoB[lob,ent][IteratorSize(NetCatNetRIPLossByLoB),IteratorSize(NetCatNetRIPLossByLoB[lob])]  = ((CDFInverseAverage(Sum[sims,mbla](NetCatNetRIPLossByLoB[lob,ent]), 99.5%, 99.7% ) * SPCatFactor["1 in 250 UY to AY"]) ) - (0.7* Sum[sims,mbla](SPCatPremium[lob,ent])) * (1 - SPCatFactor["Tax %"]) ;



CatRiskGroup = ((CDFInverseAverage(Sum[sims](NetCatNetRIPLossByLoB), 99.5%, 99.7%) *  SPCatFactor["1 in 250 UY to AY"]) - 0.7*Sum[sims](SPCatPremium)) * (1 - SPCatFactor["Tax %"]) ;

//For Reports
out StandaloneSPCapitalByLoB = Sum[0,mind]({ Sum[lob,ent]({SPPremiumRisk, SPReserveRisk}), CatRiskByLoB});

RiskTypes = {"Premium Risk","Reserve Risk","Cat Risk"};
Capital_Entity = Capital_ConstraintTable["Entity",:,"Entity"];
CapitalShape[ent,risk][Capital_Entity, RiskTypes] = 0;


//ent diversified cat risk by lob
NetCatNetRIPLossByEntLoB = Sum[ent,lob,sims](NetCatNetRIPLossByLoB);
NetCatNetRIPLossByEnt = Sum[ent,sims](NetCatNetRIPLossByEntLoB);
NetCatNetRIPLossGroup = Sum[sims](NetCatNetRIPLossByEnt);
CatRiskEntByLoBScenarios = CDFInverseAverageScenarios(NetCatNetRIPLossByEnt, 99.5%, 99.7%);
CatRiskGroupByLoBScenarios = CDFInverseAverageScenarios(NetCatNetRIPLossGroup, 99.5%, 99.7%);
SPCatPremiumByEntLoB = Sum[ent,lob](SPCatPremium);

SPCatByEntLoB[ent,lob][IteratorSize(CatRiskEntByLoBScenarios),IteratorSize(NetCatNetRIPLossByEntLoB[ent])] = 
		Sum[0,mind]({
				NetCatNetRIPLossByEntLoB[ent,lob]&lt;&lt;CatRiskEntByLoBScenarios[ent]&gt;&gt;*  SPCatFactor["1 in 250 UY to AY"],
				- 0.7* SPCatPremiumByEntLoB[ent,lob]}) * (1 - SPCatFactor["Tax %"]);

SPCapitalByEntLoB_[risk][RiskTypes] = { Sum[ent,lob](SPPremiumRisk), Sum[ent,lob](SPReserveRisk), SPCatByEntLoB};

SPCapitalByLoB_[ent,risk][{"Group"},RiskTypes] = 
		{{	Sum[lob](SPPremiumRisk), 
			Sum[lob](SPReserveRisk),
			Sum[0,mind]({ Sum[lob,mbla](NetCatNetRIPLossByLoB&lt;&lt;CatRiskGroupByLoBScenarios&gt;&gt;) *  SPCatFactor["1 in 250 UY to AY"], 
									 - 0.7* Sum[lob](SPCatPremium) * (1 - SPCatFactor["Tax %"]) })}};

SPCapitalByEntLoB = Transpose[ent,risk,lob](
		Glue[ent]( { SPCapitalByEntLoB_,
					 		Transpose[risk,ent,lob](SPCapitalByLoB_)}));
out SPCapitalByLoB[label][IteratorSize(Capital_Entity)] = SPCapitalByEntLoB [Capital_Entity[label]];

SPCapitalByGroupByRiskType[ent,risk][{"Group"},RiskTypes] = {{Sum(SPPremiumRisk) , Sum(SPReserveRisk), CatRiskGroup}};
Capital_ = PadToPattern(Glue(Sum[ent,risk](SPCapitalByEntLoB_), SPCapitalByGroupByRiskType), CapitalShape, 0);
out Capital[label][IteratorSize(Capital_Entity)] = Capital_[Capital_Entity[label]];

out SPComponents[risk][{"Premium Risk","Reserve Risk","Cat Premium"}]  = { Sum[InwardsID,ent](SPPremiumRisk), Sum[InwardsID,ent](SPReserveRisk), -0.7*Sum[InwardsID,ent,mbla](SPCatPremium) * (1 - SPCatFactor["Tax %"]) };</Text>
                  <CacheResultValues>true</CacheResultValues>
                  <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                  <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                  <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                  <NumScenariosDefault>0</NumScenariosDefault>
                  <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                  <Breakpoints />
                  <NestedSettings xmlns="" i:type="TycheSettingsContainer">
                    <InputVariables>
                      <TycheInputVariable>
                        <VariableName>CapitalSwitch</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CapitalSwitch</AncestorVariableName>
                        <IsParallel>true</IsParallel>
                        <IsBranchSelector>true</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CombinedProfit</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CombinedProfit</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>SPAdjustedFactors</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>SPAdjustedFactors</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>SPCatFactor</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>SPCatFactor</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RICatAggReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RICatAggReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RICatIndRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RICatIndRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RICatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RICatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RINonCatAggRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RINonCatAggRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RINonCatIndRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RINonCatIndRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RINonCatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RINonCatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RICatAggRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RICatAggRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RIPremium</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RIPremium</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>NonCatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>NonCatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>NonCatIndLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>NonCatIndLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>NonCatAggLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>NonCatAggLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CatIndLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CatIndLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CatAggReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CatAggReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CatAggLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CatAggLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>Premium</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>Premium</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>Commission</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>Commission</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CedingCommission</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CedingCommission</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>Capital_ConstraintTable</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>Capital_ConstraintTable</AncestorVariableName>
                        <IsParallel>true</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>PremiumByLt</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>PremiumByLt</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RIPremiumByLt</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RIPremiumByLt</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                    </InputVariables>
                    <OutputVariables />
                    <IsContainer>false</IsContainer>
                    <RandomSeed>163058860</RandomSeed>
                  </NestedSettings>
                  <Children>
                    <TycheNode xmlns="" i:type="TycheNodeNestedInputs">
                      <fAttachedData i:nil="true" />
                      <NodeType>NestedInputs</NodeType>
                      <Name>Inputs</Name>
                      <Description></Description>
                      <Author>Theo Reynolds (tr05)</Author>
                      <Text></Text>
                      <CacheResultValues>true</CacheResultValues>
                      <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                      <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                      <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                      <NumScenariosDefault>0</NumScenariosDefault>
                      <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                      <Breakpoints />
                    </TycheNode>
                    <TycheNode xmlns="" i:type="TycheNodeNestedOutputs">
                      <fAttachedData i:nil="true" />
                      <NodeType>NestedOutputs</NodeType>
                      <Name>Outputs</Name>
                      <Description></Description>
                      <Author>Theo Reynolds (tr05)</Author>
                      <Text></Text>
                      <CacheResultValues>true</CacheResultValues>
                      <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                      <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                      <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                      <NumScenariosDefault>0</NumScenariosDefault>
                      <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                      <Breakpoints />
                    </TycheNode>
                  </Children>
                  <ChildrenEdges />
                </TycheNode>
                <TycheNode xmlns="" i:type="TycheNodeContainer">
                  <fAttachedData i:nil="true" />
                  <NodeType>Container</NodeType>
                  <Name>Economic</Name>
                  <Description></Description>
                  <Author>Theo Reynolds (tr05)</Author>
                  <Text>//set up capital variables
Capital_Entity =  Capital_ConstraintTable["Entity",:,"Entity"];
Capital_LPerc = ToDouble(Capital_ConstraintTable["Lower Percentile",:,"Lower Percentile"]);
Capital_UPerc = ToDouble(Capital_ConstraintTable["Upper Percentile",:,"Upper Percentile"]);

CapitalT[risk,label][{"Economic"},IteratorSize(Capital_Entity)] = CDFInverseAverage(-CombinedProfit[Capital_Entity[label]], Capital_LPerc[label] , Capital_UPerc[label] );

out StandaloneSPCapitalByLoB[lob,ent][DummyString,DummyString] = 0;
out SPCapitalByLoB[label,risk,lob][DummyString,{"Premium Risk","Reserve Risk","Cat Risk"}, DummyString] = 0;

out Capital = Transpose[label,risk](CapitalT);
DummyString[i][0] = "";
DummyStringFixed[i][1] = "Fixed";
out SPComponents[risk,InwardsID,ent][{"Premium Risk","Reserve Risk","Cat Premium"}, DummyStringFixed, DummyString]  = 0;</Text>
                  <CacheResultValues>true</CacheResultValues>
                  <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                  <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                  <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                  <NumScenariosDefault>0</NumScenariosDefault>
                  <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                  <Breakpoints />
                  <NestedSettings xmlns="" i:type="TycheSettingsContainer">
                    <InputVariables>
                      <TycheInputVariable>
                        <VariableName>CapitalSwitch</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CapitalSwitch</AncestorVariableName>
                        <IsParallel>true</IsParallel>
                        <IsBranchSelector>true</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CombinedProfit</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CombinedProfit</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>SPAdjustedFactors</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>SPAdjustedFactors</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>SPCatFactor</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>SPCatFactor</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RICatAggReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RICatAggReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RICatIndRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RICatIndRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RICatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RICatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RINonCatAggRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RINonCatAggRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RINonCatIndRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RINonCatIndRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RINonCatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RINonCatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RICatAggRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RICatAggRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RIPremium</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RIPremium</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>NonCatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>NonCatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>NonCatIndLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>NonCatIndLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>NonCatAggLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>NonCatAggLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CatIndLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CatIndLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CatAggReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CatAggReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CatAggLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CatAggLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>Premium</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>Premium</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>Commission</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>Commission</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>CedingCommission</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>CedingCommission</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>Capital_ConstraintTable</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>Capital_ConstraintTable</AncestorVariableName>
                        <IsParallel>true</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>PremiumByLt</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>PremiumByLt</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>RIPremiumByLt</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>RIPremiumByLt</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                    </InputVariables>
                    <OutputVariables />
                    <IsContainer>false</IsContainer>
                    <RandomSeed>2125339459</RandomSeed>
                  </NestedSettings>
                  <Children>
                    <TycheNode xmlns="" i:type="TycheNodeNestedInputs">
                      <fAttachedData i:nil="true" />
                      <NodeType>NestedInputs</NodeType>
                      <Name>Inputs</Name>
                      <Description></Description>
                      <Author>Theo Reynolds (tr05)</Author>
                      <Text></Text>
                      <CacheResultValues>true</CacheResultValues>
                      <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                      <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                      <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                      <NumScenariosDefault>0</NumScenariosDefault>
                      <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                      <Breakpoints />
                    </TycheNode>
                    <TycheNode xmlns="" i:type="TycheNodeNestedOutputs">
                      <fAttachedData i:nil="true" />
                      <NodeType>NestedOutputs</NodeType>
                      <Name>Outputs</Name>
                      <Description></Description>
                      <Author>Theo Reynolds (tr05)</Author>
                      <Text></Text>
                      <CacheResultValues>true</CacheResultValues>
                      <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                      <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                      <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                      <NumScenariosDefault>0</NumScenariosDefault>
                      <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                      <Breakpoints />
                    </TycheNode>
                  </Children>
                  <ChildrenEdges />
                </TycheNode>
                <TycheNode xmlns="" i:type="TycheNodeNestedInputs">
                  <fAttachedData i:nil="true" />
                  <NodeType>NestedInputs</NodeType>
                  <Name>Inputs</Name>
                  <Description></Description>
                  <Author>Theo Reynolds (tr05)</Author>
                  <Text></Text>
                  <CacheResultValues>true</CacheResultValues>
                  <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                  <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                  <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                  <NumScenariosDefault>0</NumScenariosDefault>
                  <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                  <Breakpoints />
                </TycheNode>
                <TycheNode xmlns="" i:type="TycheNodeNestedOutputs">
                  <fAttachedData i:nil="true" />
                  <NodeType>NestedOutputs</NodeType>
                  <Name>Outputs</Name>
                  <Description></Description>
                  <Author>Theo Reynolds (tr05)</Author>
                  <Text></Text>
                  <CacheResultValues>true</CacheResultValues>
                  <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                  <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                  <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                  <NumScenariosDefault>0</NumScenariosDefault>
                  <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                  <Breakpoints />
                </TycheNode>
              </Children>
              <ChildrenEdges />
            </TycheNode>
            <TycheNode xmlns="" i:type="TycheNodeOperation">
              <fAttachedData i:nil="true" />
              <NodeType>Operation</NodeType>
              <Name>Preprocess Switch</Name>
              <Description></Description>
              <Author>Theo Reynolds (tr05)</Author>
              <Text>
arg inCapital_ConstraintTable = Inputs.Capital_ConstraintTable;
out Capital_ConstraintTable = Transpose[basis,constraint,label,list](inCapital_ConstraintTable);

//this node creates a switch which determines whether to calculate capital on S&amp;P or economic basis
out CapitalSwitch[basis][IteratorSize(Capital_ConstraintTable)] = basis;</Text>
              <CacheResultValues>true</CacheResultValues>
              <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
              <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
              <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
              <NumScenariosDefault>0</NumScenariosDefault>
              <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
              <Breakpoints />
              <NestedSettings xmlns="" i:type="TycheSettingsContainer">
                <InputVariables />
                <OutputVariables />
                <IsContainer>false</IsContainer>
                <RandomSeed>1958902544</RandomSeed>
              </NestedSettings>
              <Children />
              <ChildrenEdges />
            </TycheNode>
            <TycheNode xmlns="" i:type="TycheNodeOperation">
              <fAttachedData i:nil="true" />
              <NodeType>Operation</NodeType>
              <Name>PostProcessing</Name>
              <Description></Description>
              <Author>Theo Reynolds (tr05)</Author>
              <Text>arg CapitalSwitch = 'Preprocess Switch'.CapitalSwitch;
//this node removes the dummy switch node dimension
arg inCapital = 'Capital by Type'.Capital;
arg inSPComponents = 'Capital by Type'.SPComponents;
arg inSPCapitalByLoB = 'Capital by Type'.SPCapitalByLoB;
arg inStandaloneSPCapitalByLoB = 'Capital by Type'.StandaloneSPCapitalByLoB;

out Capital = Sum[basis,risk,mind](inCapital);
out SPComponents = inSPComponents[0];
out SPCapitalByLoB = inSPCapitalByLoB[0];
out StandaloneSPCapitalByLoB = inStandaloneSPCapitalByLoB[0];</Text>
              <CacheResultValues>true</CacheResultValues>
              <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
              <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
              <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
              <NumScenariosDefault>0</NumScenariosDefault>
              <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
              <Breakpoints />
              <NestedSettings xmlns="" i:type="TycheSettingsContainer">
                <InputVariables />
                <OutputVariables />
                <IsContainer>false</IsContainer>
                <RandomSeed>2093032749</RandomSeed>
              </NestedSettings>
              <Children />
              <ChildrenEdges />
            </TycheNode>
            <TycheNode xmlns="" i:type="TycheNodeSwitch">
              <fAttachedData i:nil="true" />
              <NodeType>Switch</NodeType>
              <Name>Apply Discounting</Name>
              <Description></Description>
              <Author>2267 (u1157691)</Author>
              <Text></Text>
              <CacheResultValues>true</CacheResultValues>
              <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
              <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
              <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
              <NumScenariosDefault>0</NumScenariosDefault>
              <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
              <Breakpoints />
              <NestedSettings xmlns="" i:type="TycheSettingsSwitch">
                <InputVariables>
                  <TycheInputVariable>
                    <VariableName>DiscountSwitch</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>DiscountSwitch</AncestorVariableName>
                    <IsParallel>true</IsParallel>
                    <IsBranchSelector>true</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>DiscountFactor</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>DiscountFactor</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inPremium</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>Premium</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inCommission</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>Commission</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inFixedExpenses</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>FixedExpenses</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inCatAggLosses</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>CatAggLosses</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inCatAggReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>CatAggReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inCatIndLosses</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>CatIndLosses</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inCatIndReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>CatIndReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inNonCatAggLosses</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>NonCatAggLosses</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inNonCatIndLosses</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>NonCatIndLosses</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inNonCatIndReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>NonCatIndReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inRIPremium</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RIPremium</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inRICatAggRecovery</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RICatAggRecovery</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inRICatAggReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RICatAggReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inRICatIndRecovery</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RICatIndRecovery</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inRICatIndReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RICatIndReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inRINonCatAggRecovery</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RINonCatAggRecovery</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inRINonCatIndRecovery</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RINonCatIndRecovery</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inRINonCatIndReinstatement</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>RINonCatIndReinstatement</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                  <TycheInputVariable>
                    <VariableName>inCedingCommission</VariableName>
                    <AncestorNodeName>Inputs</AncestorNodeName>
                    <AncestorVariableName>CedingCommission</AncestorVariableName>
                    <IsParallel>false</IsParallel>
                    <IsBranchSelector>false</IsBranchSelector>
                  </TycheInputVariable>
                </InputVariables>
                <OutputVariables>
                  <TycheOutputVariable>
                    <VariableName>Premium</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>Premium</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>Commission</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>Commission</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>FixedExpenses</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>FixedExpenses</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>CatAggLosses</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>CatAggLosses</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>CatAggReinstatement</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>CatAggReinstatement</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>CatIndLosses</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>CatIndLosses</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>CatIndReinstatement</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>CatIndReinstatement</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>NonCatAggLosses</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>NonCatAggLosses</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>NonCatIndLosses</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>NonCatIndLosses</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>NonCatIndReinstatement</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>NonCatIndReinstatement</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>RIPremium</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>RIPremium</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>RICatAggRecovery</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>RICatAggRecovery</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>RICatAggReinstatement</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>RICatAggReinstatement</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>RICatIndRecovery</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>RICatIndRecovery</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>RICatIndReinstatement</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>RICatIndReinstatement</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>RINonCatAggRecovery</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>RINonCatAggRecovery</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>RINonCatIndRecovery</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>RINonCatIndRecovery</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>RINonCatIndReinstatement</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>RINonCatIndReinstatement</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                  <TycheOutputVariable>
                    <VariableName>CedingCommission</VariableName>
                    <ChildNodeName>Yes</ChildNodeName>
                    <ChildVariableName>CedingCommission</ChildVariableName>
                    <CachedTypeData i:nil="true" />
                    <IsEnabled>true</IsEnabled>
                  </TycheOutputVariable>
                </OutputVariables>
                <IsContainer>true</IsContainer>
                <RandomSeed>2125339459</RandomSeed>
                <ParalleliseBy>TopDimension</ParalleliseBy>
                <ParallelisationMethod>Series</ParallelisationMethod>
                <NumThreads>4</NumThreads>
                <SwitchBranchSettings>
                  <TycheSettingsSwitchBranch>
                    <BranchName>Yes</BranchName>
                    <IsContainer>false</IsContainer>
                  </TycheSettingsSwitchBranch>
                  <TycheSettingsSwitchBranch>
                    <BranchName>No</BranchName>
                    <IsContainer>false</IsContainer>
                  </TycheSettingsSwitchBranch>
                </SwitchBranchSettings>
                <Grid>
                  <GridTransferType>ByRequest</GridTransferType>
                  <HostName>localhost</HostName>
                  <MaximumGridRequests>100</MaximumGridRequests>
                  <NodesJobTemplate i:nil="true" />
                  <PortRangeHighest>7460</PortRangeHighest>
                  <PortRangeLowest>7443</PortRangeLowest>
                  <Priority>
                    <Value>2000</Value>
                  </Priority>
                  <RuntimeDirectory i:nil="true" />
                  <UseGridEmulation>false</UseGridEmulation>
                  <GridSettingsOrigin>FromParent</GridSettingsOrigin>
                </Grid>
                <ReseedEachExecution>true</ReseedEachExecution>
              </NestedSettings>
              <Children>
                <TycheNode xmlns="" i:type="TycheNodeContainer">
                  <fAttachedData i:nil="true" />
                  <NodeType>Container</NodeType>
                  <Name>Yes</Name>
                  <Description></Description>
                  <Author>2267 (u1157691)</Author>
                  <Text>
inDiscountFactor = DiscountFactor;
out Premium[inPremium] = inPremium[ent,peril,lob,InwardsID] * DiscountFactor["Premium",lob,default::1];
out Commission[inCommission] = inCommission[ent,peril,lob,InwardsID] * DiscountFactor["Commissions",lob,default::1];
out FixedExpenses[inFixedExpenses] = inFixedExpenses[ent,peril,lob,InwardsID] * DiscountFactor["Fixed Expenses",lob,default::1];
out CatAggLosses[inCatAggLosses] = inCatAggLosses[ent,peril,lob,InwardsID] * DiscountFactor["Cat Loss",lob,default::1];
out CatAggReinstatement[inCatAggReinstatement] = inCatAggReinstatement[ent,peril,lob,InwardsID] * DiscountFactor["Cat RIP",lob,default::1];
out CatIndLosses[inCatIndLosses] = inCatIndLosses[ent,source,loss,peril,lob,InwardsID] * DiscountFactor["Cat Loss",lob,default::1];
out CatIndReinstatement[inCatIndReinstatement] = inCatIndReinstatement[ent,source,loss,peril,lob,InwardsID] * DiscountFactor["Cat RIP",lob,default::1];
out NonCatAggLosses[inNonCatAggLosses] = inNonCatAggLosses[ent,peril,lob,InwardsID] * DiscountFactor["NonCat Loss",lob,default::1];
out NonCatIndLosses[inNonCatIndLosses] = inNonCatIndLosses[ent,source,peril,lob,loss,InwardsID] * DiscountFactor["NonCat Loss",lob,default::1];;
out NonCatIndReinstatement[inNonCatIndReinstatement] = inNonCatIndReinstatement[ent,source,peril,lob,loss,InwardsID] * DiscountFactor["NonCat RIP",lob,default::1];;
out RIPremium[inRIPremium] = inRIPremium[id,ent,peril,lob,InwardsID] * DiscountFactor["Premium",lob,default::1];
out RICatAggRecovery[inRICatAggRecovery] = inRICatAggRecovery[id,ent,peril,lob,InwardsID]* DiscountFactor["Cat Loss",lob,default::1];
out RICatAggReinstatement[inRICatAggReinstatement] = inRICatAggReinstatement[id,ent,peril,lob,InwardsID] * DiscountFactor["Cat RIP",lob,default::1];
out RICatIndRecovery[inRICatIndRecovery] = inRICatIndRecovery[id,ent,source,loss,peril,lob,InwardsID] * DiscountFactor["Cat Loss",lob,default::1];
out RICatIndReinstatement[inRICatIndReinstatement] = inRICatIndReinstatement[id,ent,source,loss,peril,lob,InwardsID] * DiscountFactor["Cat RIP",lob,default::1];
out RINonCatAggRecovery[inRINonCatAggRecovery] = inRINonCatAggRecovery[id,ent,peril,lob,InwardsID] * DiscountFactor["NonCat Loss",lob,default::1];
out RINonCatIndRecovery[inRINonCatIndRecovery] = inRINonCatIndRecovery[id,ent,source,peril,lob,loss,InwardsID] * DiscountFactor["NonCat Loss",lob,default::1];
out RINonCatIndReinstatement[inRINonCatIndReinstatement] = inRINonCatIndReinstatement[id,ent,source,peril,lob,loss,InwardsID] * DiscountFactor["NonCat RIP",lob,default::1];
out CedingCommission[inCedingCommission] = inCedingCommission[id,ent,peril,lob,InwardsID] * DiscountFactor["Commissions",lob,default::1];


</Text>
                  <CacheResultValues>true</CacheResultValues>
                  <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                  <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                  <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                  <NumScenariosDefault>0</NumScenariosDefault>
                  <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                  <Breakpoints />
                  <NestedSettings xmlns="" i:type="TycheSettingsContainer">
                    <InputVariables>
                      <TycheInputVariable>
                        <VariableName>DiscountSwitch</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>DiscountSwitch</AncestorVariableName>
                        <IsParallel>true</IsParallel>
                        <IsBranchSelector>true</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>DiscountFactor</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>DiscountFactor</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inPremium</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inPremium</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCommission</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCommission</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inFixedExpenses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inFixedExpenses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCatAggLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCatAggLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCatAggReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCatAggReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCatIndLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCatIndLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inNonCatAggLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inNonCatAggLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inNonCatIndLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inNonCatIndLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inNonCatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inNonCatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRIPremium</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRIPremium</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRICatAggRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRICatAggRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRICatAggReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRICatAggReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRICatIndRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRICatIndRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRICatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRICatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRINonCatAggRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRINonCatAggRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRINonCatIndRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRINonCatIndRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRINonCatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRINonCatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCedingCommission</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCedingCommission</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                    </InputVariables>
                    <OutputVariables />
                    <IsContainer>false</IsContainer>
                    <RandomSeed>384216258</RandomSeed>
                  </NestedSettings>
                  <Children>
                    <TycheNode xmlns="" i:type="TycheNodeNestedInputs">
                      <fAttachedData i:nil="true" />
                      <NodeType>NestedInputs</NodeType>
                      <Name>Inputs</Name>
                      <Description></Description>
                      <Author>2267 (u1157691)</Author>
                      <Text></Text>
                      <CacheResultValues>true</CacheResultValues>
                      <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                      <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                      <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                      <NumScenariosDefault>0</NumScenariosDefault>
                      <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                      <Breakpoints />
                    </TycheNode>
                    <TycheNode xmlns="" i:type="TycheNodeNestedOutputs">
                      <fAttachedData i:nil="true" />
                      <NodeType>NestedOutputs</NodeType>
                      <Name>Outputs</Name>
                      <Description></Description>
                      <Author>2267 (u1157691)</Author>
                      <Text></Text>
                      <CacheResultValues>true</CacheResultValues>
                      <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                      <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                      <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                      <NumScenariosDefault>0</NumScenariosDefault>
                      <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                      <Breakpoints />
                    </TycheNode>
                  </Children>
                  <ChildrenEdges />
                </TycheNode>
                <TycheNode xmlns="" i:type="TycheNodeContainer">
                  <fAttachedData i:nil="true" />
                  <NodeType>Container</NodeType>
                  <Name>No</Name>
                  <Description></Description>
                  <Author>2267 (u1157691)</Author>
                  <Text>out Premium = inPremium;
out Commission = inCommission;
out FixedExpenses = inFixedExpenses;
out CatAggLosses = inCatAggLosses;
out CatAggReinstatement = inCatAggReinstatement;
out CatIndLosses = inCatIndLosses;
out CatIndReinstatement = inCatIndReinstatement;
out NonCatAggLosses = inNonCatAggLosses;
out NonCatIndLosses = inNonCatIndLosses;
out NonCatIndReinstatement = inNonCatIndReinstatement;
out RIPremium = inRIPremium;
out RICatAggRecovery = inRICatAggRecovery;
out RICatAggReinstatement = inRICatAggReinstatement;
out RICatIndRecovery = inRICatIndRecovery;
out RICatIndReinstatement = inRICatIndReinstatement;
out RINonCatAggRecovery = inRINonCatAggRecovery;
out RINonCatIndRecovery = inRINonCatIndRecovery;
out RINonCatIndReinstatement = inRINonCatIndReinstatement;
out CedingCommission = inCedingCommission;
</Text>
                  <CacheResultValues>true</CacheResultValues>
                  <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                  <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                  <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                  <NumScenariosDefault>0</NumScenariosDefault>
                  <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                  <Breakpoints />
                  <NestedSettings xmlns="" i:type="TycheSettingsContainer">
                    <InputVariables>
                      <TycheInputVariable>
                        <VariableName>DiscountSwitch</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>DiscountSwitch</AncestorVariableName>
                        <IsParallel>true</IsParallel>
                        <IsBranchSelector>true</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>DiscountFactor</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>DiscountFactor</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inPremium</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inPremium</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCommission</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCommission</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inFixedExpenses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inFixedExpenses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCatAggLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCatAggLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCatAggReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCatAggReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCatIndLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCatIndLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inNonCatAggLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inNonCatAggLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inNonCatIndLosses</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inNonCatIndLosses</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inNonCatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inNonCatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRIPremium</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRIPremium</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRICatAggRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRICatAggRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRICatAggReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRICatAggReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRICatIndRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRICatIndRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRICatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRICatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRINonCatAggRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRINonCatAggRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRINonCatIndRecovery</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRINonCatIndRecovery</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inRINonCatIndReinstatement</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inRINonCatIndReinstatement</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                      <TycheInputVariable>
                        <VariableName>inCedingCommission</VariableName>
                        <AncestorNodeName>Inputs</AncestorNodeName>
                        <AncestorVariableName>inCedingCommission</AncestorVariableName>
                        <IsParallel>false</IsParallel>
                        <IsBranchSelector>false</IsBranchSelector>
                      </TycheInputVariable>
                    </InputVariables>
                    <OutputVariables />
                    <IsContainer>false</IsContainer>
                    <RandomSeed>1958902544</RandomSeed>
                  </NestedSettings>
                  <Children>
                    <TycheNode xmlns="" i:type="TycheNodeNestedInputs">
                      <fAttachedData i:nil="true" />
                      <NodeType>NestedInputs</NodeType>
                      <Name>Inputs</Name>
                      <Description></Description>
                      <Author>2267 (u1157691)</Author>
                      <Text></Text>
                      <CacheResultValues>true</CacheResultValues>
                      <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                      <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                      <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                      <NumScenariosDefault>0</NumScenariosDefault>
                      <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                      <Breakpoints />
                    </TycheNode>
                    <TycheNode xmlns="" i:type="TycheNodeNestedOutputs">
                      <fAttachedData i:nil="true" />
                      <NodeType>NestedOutputs</NodeType>
                      <Name>Outputs</Name>
                      <Description></Description>
                      <Author>2267 (u1157691)</Author>
                      <Text></Text>
                      <CacheResultValues>true</CacheResultValues>
                      <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                      <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                      <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                      <NumScenariosDefault>0</NumScenariosDefault>
                      <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                      <Breakpoints />
                    </TycheNode>
                  </Children>
                  <ChildrenEdges />
                </TycheNode>
                <TycheNode xmlns="" i:type="TycheNodeNestedInputs">
                  <fAttachedData i:nil="true" />
                  <NodeType>NestedInputs</NodeType>
                  <Name>Inputs</Name>
                  <Description></Description>
                  <Author>2267 (u1157691)</Author>
                  <Text></Text>
                  <CacheResultValues>true</CacheResultValues>
                  <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                  <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                  <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                  <NumScenariosDefault>0</NumScenariosDefault>
                  <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                  <Breakpoints />
                </TycheNode>
                <TycheNode xmlns="" i:type="TycheNodeNestedOutputs">
                  <fAttachedData i:nil="true" />
                  <NodeType>NestedOutputs</NodeType>
                  <Name>Outputs</Name>
                  <Description></Description>
                  <Author>2267 (u1157691)</Author>
                  <Text></Text>
                  <CacheResultValues>true</CacheResultValues>
                  <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
                  <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
                  <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
                  <NumScenariosDefault>0</NumScenariosDefault>
                  <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
                  <Breakpoints />
                </TycheNode>
              </Children>
              <ChildrenEdges />
            </TycheNode>
            <TycheNode xmlns="" i:type="TycheNodeOperation">
              <fAttachedData i:nil="true" />
              <NodeType>Operation</NodeType>
              <Name>Profit</Name>
              <Description></Description>
              <Author>2267 (u1157691)</Author>
              <Text>
arg inFixedExpenses = 'Apply Discounting'.FixedExpenses;
arg inCedingCommission = 'Apply Discounting'.CedingCommission;
arg inCommission = 'Apply Discounting'.Commission;
arg inPremium = 'Apply Discounting'.Premium;
arg inCatAggLosses = 'Apply Discounting'.CatAggLosses;
arg inCatAggReinstatement = 'Apply Discounting'.CatAggReinstatement;
arg inCatIndLosses = 'Apply Discounting'.CatIndLosses;
arg inCatIndReinstatement = 'Apply Discounting'.CatIndReinstatement;
arg inNonCatAggLosses = 'Apply Discounting'.NonCatAggLosses;
arg inNonCatIndLosses = 'Apply Discounting'.NonCatIndLosses;
arg inNonCatIndReinstatement = 'Apply Discounting'.NonCatIndReinstatement;
arg inRIPremium = 'Apply Discounting'.RIPremium;
arg inRICatAggRecovery = 'Apply Discounting'.RICatAggRecovery;
arg inRICatAggReinstatement = 'Apply Discounting'.RICatAggReinstatement;
arg inRICatIndRecovery = 'Apply Discounting'.RICatIndRecovery;
arg inRICatIndReinstatement = 'Apply Discounting'.RICatIndReinstatement;
arg inRINonCatAggRecovery = 'Apply Discounting'.RINonCatAggRecovery;
arg inRINonCatIndRecovery = 'Apply Discounting'.RINonCatIndRecovery;
arg inRINonCatIndReinstatement = 'Apply Discounting'.RINonCatIndReinstatement;
arg inCapital_ConstraintTable = Inputs.Capital_ConstraintTable;
//arg inCapitalDefinition = Inputs.CapitalDefinition;

//removes the dummy switch node dimension
FixedExpenses = inFixedExpenses[0];
CedingCommission = inCedingCommission[0];
Commission = inCommission[0];
Premium = inPremium[0];
CatAggLosses = inCatAggLosses[0];
CatAggReinstatement = inCatAggReinstatement[0];
CatIndLosses = inCatIndLosses[0];
CatIndReinstatement = inCatIndReinstatement[0];
NonCatAggLosses = inNonCatAggLosses[0];
NonCatIndLosses = inNonCatIndLosses[0];
NonCatIndReinstatement = inNonCatIndReinstatement[0];
RIPremium = inRIPremium[0];
RICatAggRecovery = inRICatAggRecovery[0];
RICatAggReinstatement = inRICatAggReinstatement[0];
RICatIndRecovery = inRICatIndRecovery[0];
RICatIndReinstatement = inRICatIndReinstatement[0];
RINonCatAggRecovery = inRINonCatAggRecovery[0];
RINonCatIndRecovery = inRINonCatIndRecovery[0];
RINonCatIndReinstatement = inRINonCatIndReinstatement[0];
//CapitalDefinition = inCapitalDefinition;


// expected entity and group profit
EntityProfit =
		Sum[0,mind]( {
				Sum[ent,sims,mbla]( Premium ),
				- Sum[ent,sims,mbla](Commission),
				- Sum[ent,sims,mbla](FixedExpenses),
				- Sum[ent,sims,mbla]( CatAggLosses ),
				Sum[ent,sims,mbla]( CatAggReinstatement ),
				- Sum[ent,sims,mbla]( CatIndLosses ),
				Sum[ent,sims,mbla]( CatIndReinstatement ),
				- Sum[ent,sims,mbla]( NonCatAggLosses ),
				- Sum[ent,sims,mbla]( NonCatIndLosses ),
				Sum[ent,sims,mbla]( NonCatIndReinstatement ),
				- Sum[ent,sims,mbla]( RIPremium ),
				Sum[ent,sims,mbla](CedingCommission),
				Sum[ent,sims,mbla]( RICatAggRecovery ),
				- Sum[ent,sims,mbla]( RICatAggReinstatement ),
				Sum[ent,sims,mbla]( RICatIndRecovery ),
				- Sum[ent,sims,mbla]( RICatIndReinstatement ),
				Sum[ent,sims,mbla]( RINonCatAggRecovery ),
				Sum[ent,sims,mbla]( RINonCatIndRecovery ),
				- Sum[ent,sims,mbla]( RINonCatIndReinstatement )
		} );

GroupProfit[ent][{"Group"}] = Sum[sims,mbla]( EntityProfit );

Entities = Glue(IndexingVariable(EntityProfit), Reindex(IndexingVariable(GroupProfit),"index"));
EntityShape[ent][Entities] = ent;

out CombinedProfit = PadToPattern( Glue( EntityProfit, GroupProfit ), EntityShape, 0 );
out ExpectedProfit = Mean[sims,mind]( CombinedProfit );</Text>
              <CacheResultValues>true</CacheResultValues>
              <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
              <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
              <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
              <NumScenariosDefault>0</NumScenariosDefault>
              <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
              <Breakpoints />
              <NestedSettings xmlns="" i:type="TycheSettingsContainer">
                <InputVariables />
                <OutputVariables />
                <IsContainer>false</IsContainer>
                <RandomSeed>1461333139</RandomSeed>
              </NestedSettings>
              <Children />
              <ChildrenEdges />
            </TycheNode>
          </Children>
          <ChildrenEdges>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\Inputs</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\Preprocess Switch</SinkNodeFullName>
            </TycheEdge>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\Preprocess Switch</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\Capital by Type</SinkNodeFullName>
            </TycheEdge>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\Capital by Type</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\PostProcessing</SinkNodeFullName>
            </TycheEdge>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\PostProcessing</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\Outputs</SinkNodeFullName>
            </TycheEdge>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\Inputs</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\Capital by Type</SinkNodeFullName>
            </TycheEdge>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\Inputs</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\Apply Discounting</SinkNodeFullName>
            </TycheEdge>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\Apply Discounting</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\Profit</SinkNodeFullName>
            </TycheEdge>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\Profit</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\Capital by Type</SinkNodeFullName>
            </TycheEdge>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\Profit</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\Outputs</SinkNodeFullName>
            </TycheEdge>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\Preprocess Switch</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\PostProcessing</SinkNodeFullName>
            </TycheEdge>
            <TycheEdge>
              <SourceNodeFullName>Profit And Capital\Preprocess Switch</SourceNodeFullName>
              <SinkNodeFullName>Profit And Capital\Profit</SinkNodeFullName>
            </TycheEdge>
          </ChildrenEdges>
        </TycheNode>
        <TycheNode xmlns="" i:type="TycheNodeOperation">
          <fAttachedData i:nil="true" />
          <NodeType>Operation</NodeType>
          <Name>Premium Split</Name>
          <Description></Description>
          <Author>Theo Reynolds (tr05)</Author>
          <Text>arg RIPremium = Import.RIPremium;
arg Premium = Import.Premium;

PremiumByPl = Transpose[peril, ent, lob, InwardsID](Premium);
RIPremiumByPl = Transpose[peril, id, ent, lob, InwardsID](RIPremium);

PremiumNonCatPls[peril][SetsIntersection(IndexingVariable(PremiumByPl), {"Attritional", "Large"})] = peril;
PremiumCatPls[peril][SetsComplement(IndexingVariable(PremiumByPl), PremiumNonCatPls)] = peril;
RIPremiumNonCatPls[peril][SetsIntersection(IndexingVariable(RIPremiumByPl), {"Attritional", "Large"})] = peril;
RIPremiumCatPls[peril][SetsComplement(IndexingVariable(RIPremiumByPl), RIPremiumNonCatPls)] = peril;

out PremiumByLt[lt][{"NonCat", "Cat"}] = { Sum[peril,mind](PremiumByPl[PremiumNonCatPls]), Sum[peril,mind](PremiumByPl[PremiumCatPls]) };
out RIPremiumByLt[lt][{"NonCat", "Cat"}] = { Sum[peril,mind](RIPremiumByPl[RIPremiumNonCatPls]), Sum[peril,mind](RIPremiumByPl[RIPremiumCatPls])};</Text>
          <CacheResultValues>false</CacheResultValues>
          <NumScenariosSourceType>Unspecified</NumScenariosSourceType>
          <NumScenariosSourceNodeName></NumScenariosSourceNodeName>
          <NumScenariosSourceVariableName></NumScenariosSourceVariableName>
          <NumScenariosDefault>0</NumScenariosDefault>
          <IsUserDefinedFunctionContents>false</IsUserDefinedFunctionContents>
          <Breakpoints />
          <NestedSettings xmlns="" i:type="TycheSettingsContainer">
            <InputVariables />
            <OutputVariables />
            <IsContainer>false</IsContainer>
            <RandomSeed>314210823</RandomSeed>
          </NestedSettings>
          <Children />
          <ChildrenEdges />
        </TycheNode>
      </TopLevelModelNodes>
      <TopLevelModelEdges>
        <TycheEdge>
          <SourceNodeFullName>Calc CAT Only OEPAEP</SourceNodeFullName>
          <SinkNodeFullName>Export</SinkNodeFullName>
        </TycheEdge>
        <TycheEdge>
          <SourceNodeFullName>Calc Combined OEPAEP</SourceNodeFullName>
          <SinkNodeFullName>Export</SinkNodeFullName>
        </TycheEdge>
        <TycheEdge>
          <SourceNodeFullName>Import</SourceNodeFullName>
          <SinkNodeFullName>Calc CAT Only OEPAEP</SinkNodeFullName>
        </TycheEdge>
        <TycheEdge>
          <SourceNodeFullName>Import</SourceNodeFullName>
          <SinkNodeFullName>Calc Combined OEPAEP</SinkNodeFullName>
        </TycheEdge>
        <TycheEdge>
          <SourceNodeFullName>Import</SourceNodeFullName>
          <SinkNodeFullName>Profit And Capital</SinkNodeFullName>
        </TycheEdge>
        <TycheEdge>
          <SourceNodeFullName>Profit And Capital</SourceNodeFullName>
          <SinkNodeFullName>Export</SinkNodeFullName>
        </TycheEdge>
        <TycheEdge>
          <SourceNodeFullName>Import</SourceNodeFullName>
          <SinkNodeFullName>Premium Split</SinkNodeFullName>
        </TycheEdge>
        <TycheEdge>
          <SourceNodeFullName>Premium Split</SourceNodeFullName>
          <SinkNodeFullName>Profit And Capital</SinkNodeFullName>
        </TycheEdge>
      </TopLevelModelEdges>
    </TycheEngine>
  </TycheProjectEngineContents>
  <TycheProjectGUIContents>
    <TycheModel xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
      <FileVersion>1</FileVersion>
      <TopLevelGuiNodes>
        <TycheGuiNode>
          <Name>Export</Name>
          <ElementLeft>64</ElementLeft>
          <ElementTop>470</ElementTop>
          <ElementWidth>250</ElementWidth>
          <ElementHeight>135</ElementHeight>
          <Children />
          <VisualNodeSettings>
            <ShowIcon>true</ShowIcon>
            <ShowTitle>true</ShowTitle>
            <ShowBorder>true</ShowBorder>
            <ShowBackground>true</ShowBackground>
            <IconString></IconString>
            <TitleLocation>Embed</TitleLocation>
            <TitleColourString>#FF000000</TitleColourString>
            <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
            <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
            <BorderColourString>#FF800080</BorderColourString>
            <IsIconStandardSize>true</IsIconStandardSize>
            <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
            <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
            <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
            <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
            <FloatingTitleWidth>120</FloatingTitleWidth>
            <FloatingTitleHeight>40</FloatingTitleHeight>
          </VisualNodeSettings>
          <OutliningStatus />
          <IsBackwardsNode>false</IsBackwardsNode>
          <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
        </TycheGuiNode>
        <TycheGuiNode>
          <Name>Calc CAT Only OEPAEP</Name>
          <ElementLeft>516</ElementLeft>
          <ElementTop>149</ElementTop>
          <ElementWidth>250</ElementWidth>
          <ElementHeight>90</ElementHeight>
          <Children />
          <VisualNodeSettings>
            <ShowIcon>true</ShowIcon>
            <ShowTitle>true</ShowTitle>
            <ShowBorder>true</ShowBorder>
            <ShowBackground>true</ShowBackground>
            <IconString></IconString>
            <TitleLocation>Embed</TitleLocation>
            <TitleColourString>#FF000000</TitleColourString>
            <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
            <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
            <BorderColourString>#FF800080</BorderColourString>
            <IsIconStandardSize>true</IsIconStandardSize>
            <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
            <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
            <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
            <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
            <FloatingTitleWidth>120</FloatingTitleWidth>
            <FloatingTitleHeight>40</FloatingTitleHeight>
          </VisualNodeSettings>
          <OutliningStatus />
          <IsBackwardsNode>false</IsBackwardsNode>
          <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
        </TycheGuiNode>
        <TycheGuiNode>
          <Name>Calc Combined OEPAEP</Name>
          <ElementLeft>517</ElementLeft>
          <ElementTop>300</ElementTop>
          <ElementWidth>250</ElementWidth>
          <ElementHeight>90</ElementHeight>
          <Children />
          <VisualNodeSettings>
            <ShowIcon>true</ShowIcon>
            <ShowTitle>true</ShowTitle>
            <ShowBorder>true</ShowBorder>
            <ShowBackground>true</ShowBackground>
            <IconString></IconString>
            <TitleLocation>Embed</TitleLocation>
            <TitleColourString>#FF000000</TitleColourString>
            <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
            <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
            <BorderColourString>#FF800080</BorderColourString>
            <IsIconStandardSize>true</IsIconStandardSize>
            <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
            <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
            <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
            <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
            <FloatingTitleWidth>120</FloatingTitleWidth>
            <FloatingTitleHeight>40</FloatingTitleHeight>
          </VisualNodeSettings>
          <OutliningStatus />
          <IsBackwardsNode>false</IsBackwardsNode>
          <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
        </TycheGuiNode>
        <TycheGuiNode>
          <Name>Import</Name>
          <ElementLeft>64</ElementLeft>
          <ElementTop>24</ElementTop>
          <ElementWidth>250</ElementWidth>
          <ElementHeight>135</ElementHeight>
          <Children />
          <VisualNodeSettings>
            <ShowIcon>true</ShowIcon>
            <ShowTitle>true</ShowTitle>
            <ShowBorder>true</ShowBorder>
            <ShowBackground>true</ShowBackground>
            <IconString></IconString>
            <TitleLocation>Embed</TitleLocation>
            <TitleColourString>#FF000000</TitleColourString>
            <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
            <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
            <BorderColourString>#FF800080</BorderColourString>
            <IsIconStandardSize>true</IsIconStandardSize>
            <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
            <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
            <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
            <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
            <FloatingTitleWidth>120</FloatingTitleWidth>
            <FloatingTitleHeight>40</FloatingTitleHeight>
          </VisualNodeSettings>
          <OutliningStatus />
          <IsBackwardsNode>false</IsBackwardsNode>
          <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
        </TycheGuiNode>
        <TycheGuiNode>
          <Name>Profit And Capital</Name>
          <ElementLeft>-2</ElementLeft>
          <ElementTop>266</ElementTop>
          <ElementWidth>250</ElementWidth>
          <ElementHeight>90</ElementHeight>
          <Children>
            <TycheGuiNode>
              <Name>Inputs</Name>
              <ElementLeft>250</ElementLeft>
              <ElementTop>90</ElementTop>
              <ElementWidth>250</ElementWidth>
              <ElementHeight>90</ElementHeight>
              <Children />
              <VisualNodeSettings>
                <ShowIcon>true</ShowIcon>
                <ShowTitle>true</ShowTitle>
                <ShowBorder>true</ShowBorder>
                <ShowBackground>true</ShowBackground>
                <IconString></IconString>
                <TitleLocation>Embed</TitleLocation>
                <TitleColourString>#FF000000</TitleColourString>
                <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                <BorderColourString>#FF800080</BorderColourString>
                <IsIconStandardSize>true</IsIconStandardSize>
                <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                <FloatingTitleWidth>120</FloatingTitleWidth>
                <FloatingTitleHeight>40</FloatingTitleHeight>
              </VisualNodeSettings>
              <OutliningStatus />
              <IsBackwardsNode>false</IsBackwardsNode>
              <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
            </TycheGuiNode>
            <TycheGuiNode>
              <Name>Outputs</Name>
              <ElementLeft>251</ElementLeft>
              <ElementTop>756</ElementTop>
              <ElementWidth>250</ElementWidth>
              <ElementHeight>90</ElementHeight>
              <Children />
              <VisualNodeSettings>
                <ShowIcon>true</ShowIcon>
                <ShowTitle>true</ShowTitle>
                <ShowBorder>true</ShowBorder>
                <ShowBackground>true</ShowBackground>
                <IconString></IconString>
                <TitleLocation>Embed</TitleLocation>
                <TitleColourString>#FF000000</TitleColourString>
                <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                <BorderColourString>#FF800080</BorderColourString>
                <IsIconStandardSize>true</IsIconStandardSize>
                <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                <FloatingTitleWidth>120</FloatingTitleWidth>
                <FloatingTitleHeight>40</FloatingTitleHeight>
              </VisualNodeSettings>
              <OutliningStatus />
              <IsBackwardsNode>false</IsBackwardsNode>
              <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
            </TycheGuiNode>
            <TycheGuiNode>
              <Name>Capital by Type</Name>
              <ElementLeft>408</ElementLeft>
              <ElementTop>432</ElementTop>
              <ElementWidth>250</ElementWidth>
              <ElementHeight>90</ElementHeight>
              <Children>
                <TycheGuiNode>
                  <Name>SP</Name>
                  <ElementLeft>250</ElementLeft>
                  <ElementTop>0</ElementTop>
                  <ElementWidth>250</ElementWidth>
                  <ElementHeight>0</ElementHeight>
                  <Children>
                    <TycheGuiNode>
                      <Name>Inputs</Name>
                      <ElementLeft>250</ElementLeft>
                      <ElementTop>90</ElementTop>
                      <ElementWidth>250</ElementWidth>
                      <ElementHeight>90</ElementHeight>
                      <Children />
                      <VisualNodeSettings>
                        <ShowIcon>true</ShowIcon>
                        <ShowTitle>true</ShowTitle>
                        <ShowBorder>true</ShowBorder>
                        <ShowBackground>true</ShowBackground>
                        <IconString></IconString>
                        <TitleLocation>Embed</TitleLocation>
                        <TitleColourString>#FF000000</TitleColourString>
                        <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                        <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                        <BorderColourString>#FF800080</BorderColourString>
                        <IsIconStandardSize>true</IsIconStandardSize>
                        <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                        <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                        <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                        <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                        <FloatingTitleWidth>120</FloatingTitleWidth>
                        <FloatingTitleHeight>40</FloatingTitleHeight>
                      </VisualNodeSettings>
                      <OutliningStatus />
                      <IsBackwardsNode>false</IsBackwardsNode>
                      <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                    </TycheGuiNode>
                    <TycheGuiNode>
                      <Name>Outputs</Name>
                      <ElementLeft>250</ElementLeft>
                      <ElementTop>540</ElementTop>
                      <ElementWidth>250</ElementWidth>
                      <ElementHeight>90</ElementHeight>
                      <Children />
                      <VisualNodeSettings>
                        <ShowIcon>true</ShowIcon>
                        <ShowTitle>true</ShowTitle>
                        <ShowBorder>true</ShowBorder>
                        <ShowBackground>true</ShowBackground>
                        <IconString></IconString>
                        <TitleLocation>Embed</TitleLocation>
                        <TitleColourString>#FF000000</TitleColourString>
                        <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                        <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                        <BorderColourString>#FF800080</BorderColourString>
                        <IsIconStandardSize>true</IsIconStandardSize>
                        <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                        <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                        <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                        <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                        <FloatingTitleWidth>120</FloatingTitleWidth>
                        <FloatingTitleHeight>40</FloatingTitleHeight>
                      </VisualNodeSettings>
                      <OutliningStatus />
                      <IsBackwardsNode>false</IsBackwardsNode>
                      <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                    </TycheGuiNode>
                  </Children>
                  <VisualNodeSettings>
                    <ShowIcon>true</ShowIcon>
                    <ShowTitle>true</ShowTitle>
                    <ShowBorder>true</ShowBorder>
                    <ShowBackground>true</ShowBackground>
                    <IconString></IconString>
                    <TitleLocation>Embed</TitleLocation>
                    <TitleColourString>#FF000000</TitleColourString>
                    <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                    <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                    <BorderColourString>#FF800080</BorderColourString>
                    <IsIconStandardSize>true</IsIconStandardSize>
                    <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                    <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                    <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                    <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                    <FloatingTitleWidth>120</FloatingTitleWidth>
                    <FloatingTitleHeight>40</FloatingTitleHeight>
                  </VisualNodeSettings>
                  <OutliningStatus />
                  <IsBackwardsNode>false</IsBackwardsNode>
                  <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                </TycheGuiNode>
                <TycheGuiNode>
                  <Name>Economic</Name>
                  <ElementLeft>250</ElementLeft>
                  <ElementTop>0</ElementTop>
                  <ElementWidth>250</ElementWidth>
                  <ElementHeight>0</ElementHeight>
                  <Children>
                    <TycheGuiNode>
                      <Name>Inputs</Name>
                      <ElementLeft>250</ElementLeft>
                      <ElementTop>90</ElementTop>
                      <ElementWidth>250</ElementWidth>
                      <ElementHeight>90</ElementHeight>
                      <Children />
                      <VisualNodeSettings>
                        <ShowIcon>true</ShowIcon>
                        <ShowTitle>true</ShowTitle>
                        <ShowBorder>true</ShowBorder>
                        <ShowBackground>true</ShowBackground>
                        <IconString></IconString>
                        <TitleLocation>Embed</TitleLocation>
                        <TitleColourString>#FF000000</TitleColourString>
                        <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                        <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                        <BorderColourString>#FF800080</BorderColourString>
                        <IsIconStandardSize>true</IsIconStandardSize>
                        <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                        <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                        <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                        <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                        <FloatingTitleWidth>120</FloatingTitleWidth>
                        <FloatingTitleHeight>40</FloatingTitleHeight>
                      </VisualNodeSettings>
                      <OutliningStatus />
                      <IsBackwardsNode>false</IsBackwardsNode>
                      <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                    </TycheGuiNode>
                    <TycheGuiNode>
                      <Name>Outputs</Name>
                      <ElementLeft>250</ElementLeft>
                      <ElementTop>540</ElementTop>
                      <ElementWidth>250</ElementWidth>
                      <ElementHeight>90</ElementHeight>
                      <Children />
                      <VisualNodeSettings>
                        <ShowIcon>true</ShowIcon>
                        <ShowTitle>true</ShowTitle>
                        <ShowBorder>true</ShowBorder>
                        <ShowBackground>true</ShowBackground>
                        <IconString></IconString>
                        <TitleLocation>Embed</TitleLocation>
                        <TitleColourString>#FF000000</TitleColourString>
                        <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                        <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                        <BorderColourString>#FF800080</BorderColourString>
                        <IsIconStandardSize>true</IsIconStandardSize>
                        <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                        <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                        <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                        <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                        <FloatingTitleWidth>120</FloatingTitleWidth>
                        <FloatingTitleHeight>40</FloatingTitleHeight>
                      </VisualNodeSettings>
                      <OutliningStatus />
                      <IsBackwardsNode>false</IsBackwardsNode>
                      <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                    </TycheGuiNode>
                  </Children>
                  <VisualNodeSettings>
                    <ShowIcon>true</ShowIcon>
                    <ShowTitle>true</ShowTitle>
                    <ShowBorder>true</ShowBorder>
                    <ShowBackground>true</ShowBackground>
                    <IconString></IconString>
                    <TitleLocation>Embed</TitleLocation>
                    <TitleColourString>#FF000000</TitleColourString>
                    <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                    <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                    <BorderColourString>#FF800080</BorderColourString>
                    <IsIconStandardSize>true</IsIconStandardSize>
                    <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                    <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                    <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                    <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                    <FloatingTitleWidth>120</FloatingTitleWidth>
                    <FloatingTitleHeight>40</FloatingTitleHeight>
                  </VisualNodeSettings>
                  <OutliningStatus />
                  <IsBackwardsNode>false</IsBackwardsNode>
                  <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                </TycheGuiNode>
                <TycheGuiNode>
                  <Name>Inputs</Name>
                  <ElementLeft>250</ElementLeft>
                  <ElementTop>90</ElementTop>
                  <ElementWidth>250</ElementWidth>
                  <ElementHeight>90</ElementHeight>
                  <Children />
                  <VisualNodeSettings>
                    <ShowIcon>true</ShowIcon>
                    <ShowTitle>true</ShowTitle>
                    <ShowBorder>true</ShowBorder>
                    <ShowBackground>true</ShowBackground>
                    <IconString></IconString>
                    <TitleLocation>Embed</TitleLocation>
                    <TitleColourString>#FF000000</TitleColourString>
                    <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                    <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                    <BorderColourString>#FF800080</BorderColourString>
                    <IsIconStandardSize>true</IsIconStandardSize>
                    <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                    <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                    <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                    <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                    <FloatingTitleWidth>120</FloatingTitleWidth>
                    <FloatingTitleHeight>40</FloatingTitleHeight>
                  </VisualNodeSettings>
                  <OutliningStatus />
                  <IsBackwardsNode>false</IsBackwardsNode>
                  <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                </TycheGuiNode>
                <TycheGuiNode>
                  <Name>Outputs</Name>
                  <ElementLeft>250</ElementLeft>
                  <ElementTop>540</ElementTop>
                  <ElementWidth>250</ElementWidth>
                  <ElementHeight>90</ElementHeight>
                  <Children />
                  <VisualNodeSettings>
                    <ShowIcon>true</ShowIcon>
                    <ShowTitle>true</ShowTitle>
                    <ShowBorder>true</ShowBorder>
                    <ShowBackground>true</ShowBackground>
                    <IconString></IconString>
                    <TitleLocation>Embed</TitleLocation>
                    <TitleColourString>#FF000000</TitleColourString>
                    <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                    <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                    <BorderColourString>#FF800080</BorderColourString>
                    <IsIconStandardSize>true</IsIconStandardSize>
                    <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                    <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                    <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                    <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                    <FloatingTitleWidth>120</FloatingTitleWidth>
                    <FloatingTitleHeight>40</FloatingTitleHeight>
                  </VisualNodeSettings>
                  <OutliningStatus />
                  <IsBackwardsNode>false</IsBackwardsNode>
                  <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                </TycheGuiNode>
              </Children>
              <VisualNodeSettings>
                <ShowIcon>true</ShowIcon>
                <ShowTitle>true</ShowTitle>
                <ShowBorder>true</ShowBorder>
                <ShowBackground>true</ShowBackground>
                <IconString></IconString>
                <TitleLocation>Embed</TitleLocation>
                <TitleColourString>#FF000000</TitleColourString>
                <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                <BorderColourString>#FF800080</BorderColourString>
                <IsIconStandardSize>true</IsIconStandardSize>
                <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                <FloatingTitleWidth>120</FloatingTitleWidth>
                <FloatingTitleHeight>40</FloatingTitleHeight>
              </VisualNodeSettings>
              <OutliningStatus />
              <IsBackwardsNode>false</IsBackwardsNode>
              <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
            </TycheGuiNode>
            <TycheGuiNode>
              <Name>Preprocess Switch</Name>
              <ElementLeft>407</ElementLeft>
              <ElementTop>258</ElementTop>
              <ElementWidth>250</ElementWidth>
              <ElementHeight>90</ElementHeight>
              <Children />
              <VisualNodeSettings>
                <ShowIcon>true</ShowIcon>
                <ShowTitle>true</ShowTitle>
                <ShowBorder>true</ShowBorder>
                <ShowBackground>true</ShowBackground>
                <IconString></IconString>
                <TitleLocation>Embed</TitleLocation>
                <TitleColourString>#FF000000</TitleColourString>
                <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                <BorderColourString>#FF800080</BorderColourString>
                <IsIconStandardSize>true</IsIconStandardSize>
                <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                <FloatingTitleWidth>120</FloatingTitleWidth>
                <FloatingTitleHeight>40</FloatingTitleHeight>
              </VisualNodeSettings>
              <OutliningStatus />
              <IsBackwardsNode>false</IsBackwardsNode>
              <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
            </TycheGuiNode>
            <TycheGuiNode>
              <Name>PostProcessing</Name>
              <ElementLeft>452</ElementLeft>
              <ElementTop>576</ElementTop>
              <ElementWidth>250</ElementWidth>
              <ElementHeight>90</ElementHeight>
              <Children />
              <VisualNodeSettings>
                <ShowIcon>true</ShowIcon>
                <ShowTitle>true</ShowTitle>
                <ShowBorder>true</ShowBorder>
                <ShowBackground>true</ShowBackground>
                <IconString></IconString>
                <TitleLocation>Embed</TitleLocation>
                <TitleColourString>#FF000000</TitleColourString>
                <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                <BorderColourString>#FF800080</BorderColourString>
                <IsIconStandardSize>true</IsIconStandardSize>
                <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                <FloatingTitleWidth>120</FloatingTitleWidth>
                <FloatingTitleHeight>40</FloatingTitleHeight>
              </VisualNodeSettings>
              <OutliningStatus />
              <IsBackwardsNode>false</IsBackwardsNode>
              <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
            </TycheGuiNode>
            <TycheGuiNode>
              <Name>Apply Discounting</Name>
              <ElementLeft>54</ElementLeft>
              <ElementTop>263</ElementTop>
              <ElementWidth>250</ElementWidth>
              <ElementHeight>90</ElementHeight>
              <Children>
                <TycheGuiNode>
                  <Name>Yes</Name>
                  <ElementLeft>250</ElementLeft>
                  <ElementTop>0</ElementTop>
                  <ElementWidth>250</ElementWidth>
                  <ElementHeight>0</ElementHeight>
                  <Children>
                    <TycheGuiNode>
                      <Name>Inputs</Name>
                      <ElementLeft>250</ElementLeft>
                      <ElementTop>90</ElementTop>
                      <ElementWidth>250</ElementWidth>
                      <ElementHeight>90</ElementHeight>
                      <Children />
                      <VisualNodeSettings>
                        <ShowIcon>true</ShowIcon>
                        <ShowTitle>true</ShowTitle>
                        <ShowBorder>true</ShowBorder>
                        <ShowBackground>true</ShowBackground>
                        <IconString></IconString>
                        <TitleLocation>Embed</TitleLocation>
                        <TitleColourString>#FF000000</TitleColourString>
                        <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                        <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                        <BorderColourString>#FF800080</BorderColourString>
                        <IsIconStandardSize>true</IsIconStandardSize>
                        <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                        <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                        <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                        <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                        <FloatingTitleWidth>120</FloatingTitleWidth>
                        <FloatingTitleHeight>40</FloatingTitleHeight>
                      </VisualNodeSettings>
                      <OutliningStatus />
                      <IsBackwardsNode>false</IsBackwardsNode>
                      <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                    </TycheGuiNode>
                    <TycheGuiNode>
                      <Name>Outputs</Name>
                      <ElementLeft>249</ElementLeft>
                      <ElementTop>565</ElementTop>
                      <ElementWidth>250</ElementWidth>
                      <ElementHeight>90</ElementHeight>
                      <Children />
                      <VisualNodeSettings>
                        <ShowIcon>true</ShowIcon>
                        <ShowTitle>true</ShowTitle>
                        <ShowBorder>true</ShowBorder>
                        <ShowBackground>true</ShowBackground>
                        <IconString></IconString>
                        <TitleLocation>Embed</TitleLocation>
                        <TitleColourString>#FF000000</TitleColourString>
                        <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                        <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                        <BorderColourString>#FF800080</BorderColourString>
                        <IsIconStandardSize>true</IsIconStandardSize>
                        <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                        <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                        <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                        <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                        <FloatingTitleWidth>120</FloatingTitleWidth>
                        <FloatingTitleHeight>40</FloatingTitleHeight>
                      </VisualNodeSettings>
                      <OutliningStatus />
                      <IsBackwardsNode>false</IsBackwardsNode>
                      <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                    </TycheGuiNode>
                  </Children>
                  <VisualNodeSettings>
                    <ShowIcon>true</ShowIcon>
                    <ShowTitle>true</ShowTitle>
                    <ShowBorder>true</ShowBorder>
                    <ShowBackground>true</ShowBackground>
                    <IconString></IconString>
                    <TitleLocation>Embed</TitleLocation>
                    <TitleColourString>#FF000000</TitleColourString>
                    <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                    <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                    <BorderColourString>#FF800080</BorderColourString>
                    <IsIconStandardSize>true</IsIconStandardSize>
                    <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                    <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                    <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                    <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                    <FloatingTitleWidth>120</FloatingTitleWidth>
                    <FloatingTitleHeight>40</FloatingTitleHeight>
                  </VisualNodeSettings>
                  <OutliningStatus />
                  <IsBackwardsNode>false</IsBackwardsNode>
                  <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                </TycheGuiNode>
                <TycheGuiNode>
                  <Name>No</Name>
                  <ElementLeft>250</ElementLeft>
                  <ElementTop>0</ElementTop>
                  <ElementWidth>250</ElementWidth>
                  <ElementHeight>0</ElementHeight>
                  <Children>
                    <TycheGuiNode>
                      <Name>Inputs</Name>
                      <ElementLeft>250</ElementLeft>
                      <ElementTop>90</ElementTop>
                      <ElementWidth>250</ElementWidth>
                      <ElementHeight>90</ElementHeight>
                      <Children />
                      <VisualNodeSettings>
                        <ShowIcon>true</ShowIcon>
                        <ShowTitle>true</ShowTitle>
                        <ShowBorder>true</ShowBorder>
                        <ShowBackground>true</ShowBackground>
                        <IconString></IconString>
                        <TitleLocation>Embed</TitleLocation>
                        <TitleColourString>#FF000000</TitleColourString>
                        <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                        <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                        <BorderColourString>#FF800080</BorderColourString>
                        <IsIconStandardSize>true</IsIconStandardSize>
                        <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                        <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                        <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                        <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                        <FloatingTitleWidth>120</FloatingTitleWidth>
                        <FloatingTitleHeight>40</FloatingTitleHeight>
                      </VisualNodeSettings>
                      <OutliningStatus />
                      <IsBackwardsNode>false</IsBackwardsNode>
                      <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                    </TycheGuiNode>
                    <TycheGuiNode>
                      <Name>Outputs</Name>
                      <ElementLeft>250</ElementLeft>
                      <ElementTop>540</ElementTop>
                      <ElementWidth>250</ElementWidth>
                      <ElementHeight>90</ElementHeight>
                      <Children />
                      <VisualNodeSettings>
                        <ShowIcon>true</ShowIcon>
                        <ShowTitle>true</ShowTitle>
                        <ShowBorder>true</ShowBorder>
                        <ShowBackground>true</ShowBackground>
                        <IconString></IconString>
                        <TitleLocation>Embed</TitleLocation>
                        <TitleColourString>#FF000000</TitleColourString>
                        <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                        <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                        <BorderColourString>#FF800080</BorderColourString>
                        <IsIconStandardSize>true</IsIconStandardSize>
                        <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                        <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                        <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                        <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                        <FloatingTitleWidth>120</FloatingTitleWidth>
                        <FloatingTitleHeight>40</FloatingTitleHeight>
                      </VisualNodeSettings>
                      <OutliningStatus />
                      <IsBackwardsNode>false</IsBackwardsNode>
                      <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                    </TycheGuiNode>
                  </Children>
                  <VisualNodeSettings>
                    <ShowIcon>true</ShowIcon>
                    <ShowTitle>true</ShowTitle>
                    <ShowBorder>true</ShowBorder>
                    <ShowBackground>true</ShowBackground>
                    <IconString></IconString>
                    <TitleLocation>Embed</TitleLocation>
                    <TitleColourString>#FF000000</TitleColourString>
                    <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                    <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                    <BorderColourString>#FF800080</BorderColourString>
                    <IsIconStandardSize>true</IsIconStandardSize>
                    <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                    <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                    <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                    <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                    <FloatingTitleWidth>120</FloatingTitleWidth>
                    <FloatingTitleHeight>40</FloatingTitleHeight>
                  </VisualNodeSettings>
                  <OutliningStatus />
                  <IsBackwardsNode>false</IsBackwardsNode>
                  <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                </TycheGuiNode>
                <TycheGuiNode>
                  <Name>Inputs</Name>
                  <ElementLeft>250</ElementLeft>
                  <ElementTop>90</ElementTop>
                  <ElementWidth>250</ElementWidth>
                  <ElementHeight>90</ElementHeight>
                  <Children />
                  <VisualNodeSettings>
                    <ShowIcon>true</ShowIcon>
                    <ShowTitle>true</ShowTitle>
                    <ShowBorder>true</ShowBorder>
                    <ShowBackground>true</ShowBackground>
                    <IconString></IconString>
                    <TitleLocation>Embed</TitleLocation>
                    <TitleColourString>#FF000000</TitleColourString>
                    <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                    <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                    <BorderColourString>#FF800080</BorderColourString>
                    <IsIconStandardSize>true</IsIconStandardSize>
                    <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                    <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                    <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                    <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                    <FloatingTitleWidth>120</FloatingTitleWidth>
                    <FloatingTitleHeight>40</FloatingTitleHeight>
                  </VisualNodeSettings>
                  <OutliningStatus />
                  <IsBackwardsNode>false</IsBackwardsNode>
                  <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                </TycheGuiNode>
                <TycheGuiNode>
                  <Name>Outputs</Name>
                  <ElementLeft>250</ElementLeft>
                  <ElementTop>540</ElementTop>
                  <ElementWidth>250</ElementWidth>
                  <ElementHeight>90</ElementHeight>
                  <Children />
                  <VisualNodeSettings>
                    <ShowIcon>true</ShowIcon>
                    <ShowTitle>true</ShowTitle>
                    <ShowBorder>true</ShowBorder>
                    <ShowBackground>true</ShowBackground>
                    <IconString></IconString>
                    <TitleLocation>Embed</TitleLocation>
                    <TitleColourString>#FF000000</TitleColourString>
                    <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                    <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                    <BorderColourString>#FF800080</BorderColourString>
                    <IsIconStandardSize>true</IsIconStandardSize>
                    <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                    <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                    <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                    <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                    <FloatingTitleWidth>120</FloatingTitleWidth>
                    <FloatingTitleHeight>40</FloatingTitleHeight>
                  </VisualNodeSettings>
                  <OutliningStatus />
                  <IsBackwardsNode>false</IsBackwardsNode>
                  <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
                </TycheGuiNode>
              </Children>
              <VisualNodeSettings>
                <ShowIcon>true</ShowIcon>
                <ShowTitle>true</ShowTitle>
                <ShowBorder>true</ShowBorder>
                <ShowBackground>true</ShowBackground>
                <IconString></IconString>
                <TitleLocation>Embed</TitleLocation>
                <TitleColourString>#FF000000</TitleColourString>
                <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                <BorderColourString>#FF800080</BorderColourString>
                <IsIconStandardSize>true</IsIconStandardSize>
                <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                <FloatingTitleWidth>120</FloatingTitleWidth>
                <FloatingTitleHeight>40</FloatingTitleHeight>
              </VisualNodeSettings>
              <OutliningStatus />
              <IsBackwardsNode>false</IsBackwardsNode>
              <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
            </TycheGuiNode>
            <TycheGuiNode>
              <Name>Profit</Name>
              <ElementLeft>55</ElementLeft>
              <ElementTop>436</ElementTop>
              <ElementWidth>250</ElementWidth>
              <ElementHeight>90</ElementHeight>
              <Children />
              <VisualNodeSettings>
                <ShowIcon>true</ShowIcon>
                <ShowTitle>true</ShowTitle>
                <ShowBorder>true</ShowBorder>
                <ShowBackground>true</ShowBackground>
                <IconString></IconString>
                <TitleLocation>Embed</TitleLocation>
                <TitleColourString>#FF000000</TitleColourString>
                <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
                <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
                <BorderColourString>#FF800080</BorderColourString>
                <IsIconStandardSize>true</IsIconStandardSize>
                <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
                <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
                <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
                <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
                <FloatingTitleWidth>120</FloatingTitleWidth>
                <FloatingTitleHeight>40</FloatingTitleHeight>
              </VisualNodeSettings>
              <OutliningStatus />
              <IsBackwardsNode>false</IsBackwardsNode>
              <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
            </TycheGuiNode>
          </Children>
          <VisualNodeSettings>
            <ShowIcon>true</ShowIcon>
            <ShowTitle>true</ShowTitle>
            <ShowBorder>true</ShowBorder>
            <ShowBackground>true</ShowBackground>
            <IconString></IconString>
            <TitleLocation>Embed</TitleLocation>
            <TitleColourString>#FF000000</TitleColourString>
            <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
            <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
            <BorderColourString>#FF800080</BorderColourString>
            <IsIconStandardSize>true</IsIconStandardSize>
            <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
            <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
            <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
            <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
            <FloatingTitleWidth>120</FloatingTitleWidth>
            <FloatingTitleHeight>40</FloatingTitleHeight>
          </VisualNodeSettings>
          <OutliningStatus />
          <IsBackwardsNode>false</IsBackwardsNode>
          <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
        </TycheGuiNode>
        <TycheGuiNode>
          <Name>Premium Split</Name>
          <ElementLeft>-285</ElementLeft>
          <ElementTop>107</ElementTop>
          <ElementWidth>250</ElementWidth>
          <ElementHeight>90</ElementHeight>
          <Children />
          <VisualNodeSettings>
            <ShowIcon>true</ShowIcon>
            <ShowTitle>true</ShowTitle>
            <ShowBorder>true</ShowBorder>
            <ShowBackground>true</ShowBackground>
            <IconString></IconString>
            <TitleLocation>Embed</TitleLocation>
            <TitleColourString>#FF000000</TitleColourString>
            <BackgroundColour1String>#FFFAFBE9</BackgroundColour1String>
            <BackgroundColour2String>#FFFFD700</BackgroundColour2String>
            <BorderColourString>#FF800080</BorderColourString>
            <IsIconStandardSize>true</IsIconStandardSize>
            <FloatingTitleBackgroundColourString>#FFFFFFFF</FloatingTitleBackgroundColourString>
            <FloatingTitleBorderColourString>#FF800080</FloatingTitleBorderColourString>
            <FloatingTitleOffsetX>0</FloatingTitleOffsetX>
            <FloatingTitleOffsetY>0</FloatingTitleOffsetY>
            <FloatingTitleWidth>120</FloatingTitleWidth>
            <FloatingTitleHeight>40</FloatingTitleHeight>
          </VisualNodeSettings>
          <OutliningStatus />
          <IsBackwardsNode>false</IsBackwardsNode>
          <ExcludeFromModelInspection>false</ExcludeFromModelInspection>
        </TycheGuiNode>
      </TopLevelGuiNodes>
      <DebuggingSettings i:nil="true" />
      <DefaultGridCellFormat i:nil="true" />
      <ModelInspectionSettings i:nil="true" />
    </TycheModel>
  </TycheProjectGUIContents>
</TycheProject>